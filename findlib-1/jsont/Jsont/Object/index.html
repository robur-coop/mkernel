<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Object (docs.findlib-1.jsont.Jsont.Object)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../../index.html">Index</a> &#x00BB; <a href="../../../../index.html">docs</a> &#x00BB; <a href="../../../index.html">findlib-1</a> &#x00BB; <a href="../../index.html">jsont</a> &#x00BB; <a href="../index.html">Jsont</a> &#x00BB; Object</nav><header class="odoc-preamble"><h1>Module <code><span>Jsont.Object</span></code></h1><p>Mapping JSON objects.</p></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#maps">Maps</a></li><li><a href="#mems">Members</a></li><li><a href="#cases">Case objects</a></li><li><a href="#unknown_members">Unknown members</a></li><li><a href="#types">JSON types</a></li></ul></nav></div><div class="odoc-content"><h2 id="maps"><a href="#maps" class="anchor"></a>Maps</h2><div class="odoc-spec"><div class="spec type anchored" id="type-map"><a href="#type-map" class="anchor"></a><code><span><span class="keyword">type</span> <span>('o, 'dec) map</span></span></code></div><div class="spec-doc"><p>The type for mapping JSON objects to values of type <code>'o</code>. The <code>'dec</code> type is used to construct <code>'o</code> from members see <a href="#val-mem"><code>mem</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-map"><a href="#val-map" class="anchor"></a><code><span><span class="keyword">val</span> map : <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'dec</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'o</span>, <span class="type-var">'dec</span>)</span> <a href="#type-map">map</a></span></span></code></div><div class="spec-doc"><p><code>map dec</code> is an empty JSON object decoded by function <code>dec</code>.</p><ul><li><code>kind</code> names the entities represented by the map and <code>doc</code> documents them. Both default to <code>&quot;&quot;</code>.</li><li><code>dec</code> is a constructor eventually returning a value of type <code>'o</code> to be saturated with calls to <a href="#val-mem"><code>mem</code></a>, <a href="#val-case_mem"><code>case_mem</code></a> or <a href="#val-keep_unknown"><code>keep_unknown</code></a>. This is needed for decoding. Use <a href="#val-enc_only"><code>enc_only</code></a> if the result is only used for encoding.</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-map'"><a href="#val-map'" class="anchor"></a><code><span><span class="keyword">val</span> map' : 
  <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?enc_meta</span>:<span>(<span><span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span> <a href="../Meta/index.html#type-t">Meta.t</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="../Meta/index.html#type-t">Meta.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'dec</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'o</span>, <span class="type-var">'dec</span>)</span> <a href="#type-map">map</a></span></span></code></div><div class="spec-doc"><p><code>map' dec</code> is like <a href="#val-map"><code>map</code></a> except you get the object's decoding metdata in <code>dec</code> and <code>enc_meta</code> is used to recover it on encoding.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-enc_only"><a href="#val-enc_only" class="anchor"></a><code><span><span class="keyword">val</span> enc_only : 
  <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?enc_meta</span>:<span>(<span><span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span> <a href="../Meta/index.html#type-t">Meta.t</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'o</span>, <span class="type-var">'a</span>)</span> <a href="#type-map">map</a></span></span></code></div><div class="spec-doc"><p><code>enc_only ()</code> is like <a href="#val-map'"><code>map'</code></a> but can only be used for encoding.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-finish"><a href="#val-finish" class="anchor"></a><code><span><span class="keyword">val</span> finish : <span><span><span>(<span class="type-var">'o</span>, <span class="type-var">'o</span>)</span> <a href="#type-map">map</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'o</span> <a href="../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>finish map</code> is a JSON type for objects mapped by <code>map</code>. Raises <code>Invalid_argument</code> if <code>map</code> describes a member name more than once.</p></div></div><h2 id="mems"><a href="#mems" class="anchor"></a>Members</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Mem"><a href="#module-Mem" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Mem/index.html">Mem</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Member maps.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mem"><a href="#val-mem" class="anchor"></a><code><span><span class="keyword">val</span> mem : 
  <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dec_absent</span>:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?enc</span>:<span>(<span><span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?enc_omit</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'o</span>, <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <a href="#type-map">map</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'o</span>, <span class="type-var">'b</span>)</span> <a href="#type-map">map</a></span></span></code></div><div class="spec-doc"><p><code>mem name t map</code> is a member named <code>name</code> of type <code>t</code> for an object of type <code>'o</code> being constructed by <code>map</code>.</p><ul><li><code>doc</code> is a documentation string for the member. Defaults to <code>&quot;&quot;</code>.</li><li><code>dec_absent</code>, if specified, is the value used for the decoding direction when the member named <code>name</code> is missing. If unspecified decoding errors when the member is absent. See also <a href="#val-opt_mem"><code>opt_mem</code></a> and <span class="xref-unresolved" title="cookbook.optional_members">this example</span>.</li><li><code>enc</code> is used to project the member's value from the object representation <code>'o</code> for encoding to JSON with <code>t</code>. It can be omitted if the result is only used for decoding.</li><li><code>enc_omit</code> is for the encoding direction. If the member value returned by <code>enc</code> returns <code>true</code> on <code>enc_omit</code>, the member is omited in the encoded JSON object. Defaults to <code>Fun.const false</code>. See also <a href="#val-opt_mem"><code>opt_mem</code></a> and <span class="xref-unresolved" title="cookbook.optional_members">this example</span>.</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-opt_mem"><a href="#val-opt_mem" class="anchor"></a><code><span><span class="keyword">val</span> opt_mem : 
  <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?enc</span>:<span>(<span><span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> option</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'o</span>, <span><span><span class="type-var">'a</span> option</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <a href="#type-map">map</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'o</span>, <span class="type-var">'b</span>)</span> <a href="#type-map">map</a></span></span></code></div><div class="spec-doc"><p><code>opt_mem name t map</code> is:</p><pre class="language-ocaml"><code>  let dec_absent = None and enc_omit = Option.is_none in
  Jsont.Object.mem name (Jsont.some t) map ~dec_absent ~enc_omit</code></pre><p>A shortcut to represent optional members of type <code>'a</code> with <code>'a option</code> values.</p></div></div><h2 id="cases"><a href="#cases" class="anchor"></a>Case objects</h2><p>Read the <span class="xref-unresolved" title="cookbook.cases">cookbook</span> on case objects.</p><div class="odoc-spec"><div class="spec module anchored" id="module-Case"><a href="#module-Case" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Case/index.html">Case</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Case objects.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-case_mem"><a href="#val-case_mem" class="anchor"></a><code><span><span class="keyword">val</span> case_mem : 
  <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?tag_compare</span>:<span>(<span><span class="type-var">'tag</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'tag</span> <span class="arrow">&#45;&gt;</span></span> int)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?tag_to_string</span>:<span>(<span><span class="type-var">'tag</span> <span class="arrow">&#45;&gt;</span></span> string)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dec_absent</span>:<span class="type-var">'tag</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?enc</span>:<span>(<span><span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'cases</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?enc_omit</span>:<span>(<span><span class="type-var">'tag</span> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?enc_case</span>:<span>(<span><span class="type-var">'cases</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'cases</span>, <span class="type-var">'tag</span>)</span> <a href="Case/index.html#type-value">Case.value</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'tag</span> <a href="../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span>(<span class="type-var">'cases</span>, <span class="type-var">'tag</span>)</span> <a href="Case/index.html#type-t">Case.t</a></span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'o</span>, <span><span class="type-var">'cases</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <a href="#type-map">map</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'o</span>, <span class="type-var">'a</span>)</span> <a href="#type-map">map</a></span></span></code></div><div class="spec-doc"><p><code>case_mem name t cases map</code> is mostly like <a href="#val-mem"><code>mem</code></a> except the member <code>name</code> selects an object representation according to the member value of type <code>t</code>:</p><ul><li><code>doc</code> is a documentation string for the member. Defaults to <code>&quot;&quot;</code>.</li><li><code>tag_compare</code> is used to compare tags. Defaults to <a href="../../../../stdlib/Stdlib/index.html#val-compare"><code>Stdlib.compare</code></a></li><li><code>tag_to_string</code> is used to stringify tags for improving error reporting.</li><li><code>dec_absent</code>, if specified, is the case value used for the decoding direction when the case member named <code>name</code> is missing. If unspecified decoding errors when the member is absent.</li><li><code>enc</code> is used to project the value in which cases are stored from the object representation <code>'o</code> for encoding to JSON. It can be omitted if the result is only used for decoding.</li><li><code>enc_case</code> determines the actual case value from the value returned by <code>enc</code>.</li><li><code>enc_omit</code> is used on the tag of the case returned by <code>enc_case</code> to determine if the case member can be ommited in the encoded JSON object</li><li><code>cases</code> enumerates all the cases, it is needed for decoding.</li></ul><p>The names of the members of each case must be disjoint from <code>name</code> or those of <code>map</code> otherwise <code>Invalid_argument</code> is raised on <a href="#val-finish"><code>finish</code></a>. Raises <code>Invalid_argument</code> if <code>case_mem</code> was already called on map.</p></div></div><h2 id="unknown_members"><a href="#unknown_members" class="anchor"></a>Unknown members</h2><p>Read the <span class="xref-unresolved" title="cookbook.unknown_members">cookbook</span> on unknown object members.</p><p>On <a href="#cases" title="cases">case objects</a> each individual case has its own behaviour unless the combinators are used on the case object map in which case it overrides the behaviour of cases. For those cases that use <a href="#val-keep_unknown"><code>keep_unknown</code></a> they will get the result of an empty builder in their decoding function and the encoder is ignored on encode.</p><div class="odoc-spec"><div class="spec module anchored" id="module-Mems"><a href="#module-Mems" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Mems/index.html">Mems</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Uniform members.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-skip_unknown"><a href="#val-skip_unknown" class="anchor"></a><code><span><span class="keyword">val</span> skip_unknown : <span><span><span>(<span class="type-var">'o</span>, <span class="type-var">'dec</span>)</span> <a href="#type-map">map</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'o</span>, <span class="type-var">'dec</span>)</span> <a href="#type-map">map</a></span></span></code></div><div class="spec-doc"><p><code>skip_unknown map</code> makes <code>map</code> skip unknown members. This is the default, no need to specify it. Raises <code>Invalid_argument</code> if <a href="#val-keep_unknown"><code>keep_unknown</code></a> was already specified on <code>map</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-error_unknown"><a href="#val-error_unknown" class="anchor"></a><code><span><span class="keyword">val</span> error_unknown : <span><span><span>(<span class="type-var">'o</span>, <span class="type-var">'dec</span>)</span> <a href="#type-map">map</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'o</span>, <span class="type-var">'dec</span>)</span> <a href="#type-map">map</a></span></span></code></div><div class="spec-doc"><p><code>error_unknown map</code> makes <code>map</code> error on unknown members. Raises <code>Invalid_argument</code> if <a href="#val-keep_unknown"><code>keep_unknown</code></a> was already specified on <code>map</code>. See <span class="xref-unresolved" title="cookbook.erroring">this example</span>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-keep_unknown"><a href="#val-keep_unknown" class="anchor"></a><code><span><span class="keyword">val</span> keep_unknown : 
  <span><span class="optlabel">?enc</span>:<span>(<span><span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'mems</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'mems</span>, <span class="type-var">_</span>, <span class="type-var">_</span>)</span> <a href="Mems/index.html#type-map">Mems.map</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'o</span>, <span><span class="type-var">'mems</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <a href="#type-map">map</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'o</span>, <span class="type-var">'a</span>)</span> <a href="#type-map">map</a></span></span></code></div><div class="spec-doc"><p><code>keep_unknown mems map</code> makes <code>map</code> keep unknown member with <code>mems</code>. Raises <code>Invalid_argument</code> if <a href="#val-keep_unknown"><code>keep_unknown</code></a> was already specified on <code>map</code>. See this <span class="xref-unresolved" title="cookbook.keeping">this example</span>, <a href="Mems/index.html#val-string_map"><code>Mems.string_map</code></a> and <a href="../index.html#val-json_mems"><code>Jsont.json_mems</code></a>.</p></div></div><h2 id="types"><a href="#types" class="anchor"></a>JSON types</h2><div class="odoc-spec"><div class="spec value anchored" id="val-as_string_map"><a href="#val-as_string_map" class="anchor"></a><code><span><span class="keyword">val</span> as_string_map : 
  <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../../../../stdlib/Stdlib/Map/Make/index.html#type-t">Map.Make(String).t</a></span> <a href="../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>as_string_map t</code> maps object to key-value maps of type <code>t</code>. See also <a href="Mems/index.html#val-string_map"><code>Mems.string_map</code></a> and <a href="../index.html#val-json_mems"><code>Jsont.json_mems</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-zero"><a href="#val-zero" class="anchor"></a><code><span><span class="keyword">val</span> zero : <span>unit <a href="../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>zero</code> ignores JSON objects on decoding and encodes an empty object.</p></div></div></div></body></html>
