<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Jsont (docs.findlib-1.jsont.Jsont)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../index.html">Index</a> &#x00BB; <a href="../../../index.html">docs</a> &#x00BB; <a href="../../index.html">findlib-1</a> &#x00BB; <a href="../index.html">jsont</a> &#x00BB; Jsont</nav><header class="odoc-preamble"><h1>Module <code><span>Jsont</span></code></h1><p>Types for JSON values.</p><p>This module provides a type for describing subsets of JSON values as bidirectional maps with arbitrary OCaml values. We call these values <em>JSON types</em>.</p><p>In these maps the <em>decoding</em> direction maps from JSON values to OCaml values and the <em>encoding</em> direction maps from OCaml values to JSON values. Depending on your needs, one direction or the other can be left unspecified. Some of the decoding maps may be lossy or creative which leads to JSON queries and transforms.</p><p>Read the <span class="xref-unresolved" title="index.quick_start">quick start</span> and the <span class="xref-unresolved" title="cookbook">cookbook</span>.</p></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#preliminaries">Preliminaries</a></li><li><a href="#types">Types</a></li><li><a href="#base">Base types</a><ul><li><a href="#option">Nulls and options</a></li><li><a href="#booleans">Booleans</a></li><li><a href="#numbers">Numbers</a></li><li><a href="#enums">Strings and enums</a></li></ul></li><li><a href="#arrays">Arrays and tuples</a></li><li><a href="#objects">Objects</a></li><li><a href="#any">Any</a></li><li><a href="#maps">Maps &amp; recursion</a></li><li><a href="#ignoring">Ignoring</a></li><li><a href="#generic_json">Generic JSON</a></li><li><a href="#queries">Queries and updates</a><ul><li><a href="#array_queries">Arrays</a></li><li><a href="#object_queries">Objects</a></li><li><a href="#index_queries">Indices</a></li><li><a href="#path_queries">Paths</a></li></ul></li><li><a href="#fmt">Formatting</a></li><li><a href="#low">Low-level representation</a></li></ul></nav></div><div class="odoc-content"><h2 id="preliminaries"><a href="#preliminaries" class="anchor"></a>Preliminaries</h2><div class="odoc-spec"><div class="spec type anchored" id="type-fmt"><a href="#type-fmt" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a fmt</span></span><span> = <span><a href="../../../stdlib/Stdlib/Format/index.html#type-formatter">Format.formatter</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>The type for formatters of values of type <code>'a</code>.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Textloc"><a href="#module-Textloc" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Textloc/index.html">Textloc</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Text locations.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Meta"><a href="#module-Meta" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Meta/index.html">Meta</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Abstract syntax tree node metadata.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-node"><a href="#type-node" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a node</span></span><span> = <span class="type-var">'a</span> * <a href="Meta/index.html#type-t">Meta.t</a></span></code></div><div class="spec-doc"><p>The type for abstract syntax tree nodes. The node data of type <code>'a</code> and its metadata.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Path"><a href="#module-Path" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Path/index.html">Path</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>JSON paths.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Sort"><a href="#module-Sort" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Sort/index.html">Sort</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Sorts of JSON values.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Error"><a href="#module-Error" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Error/index.html">Error</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Encoding, decoding and query errors.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Error"><a href="#exception-Error" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Error</span> <span class="keyword">of</span> <a href="Error/index.html#type-t">Error.t</a></span></code></div><div class="spec-doc"><p>The exception raised on map errors. In general codec and query functions turn that for you into a <a href="../../../stdlib/Stdlib/index.html#type-result"><code>result</code></a> value.</p></div></div><h2 id="types"><a href="#types" class="anchor"></a>Types</h2><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span></code></div><div class="spec-doc"><p>The type for JSON types.</p><p>A value of this type represents a subset of JSON values mapped to a subset of values of type <code>'a</code> and vice versa.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-kinded_sort"><a href="#val-kinded_sort" class="anchor"></a><code><span><span class="keyword">val</span> kinded_sort : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>kinded_sort t</code> is a human readable string describing the JSON values typed by <code>t</code>. This combines the kind of the map with the <a href="Sort/index.html" title="Sort">sort</a>(s) of JSON value mapped by <code>t</code>. For example if <code>t</code> is an object map and the kind specified for the <a href="Object/index.html#val-map" title="Object.map">map</a> is <code>&quot;T&quot;</code> then this is <code>&quot;T object&quot;</code>, if the kind is empty this is simply <code>&quot;object&quot;</code>. See also <a href="Sort/index.html#val-kinded"><code>Sort.kinded</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-kind"><a href="#val-kind" class="anchor"></a><code><span><span class="keyword">val</span> kind : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>kind t</code> is the <code>kind</code> of the underlying map. If the kind is an empty string this falls back to mention the <a href="Sort/index.html" title="Sort">sort</a>. For example if <code>t</code> is an object map and the kind specified for the <a href="Object/index.html#val-map" title="Object.map">map</a> is <code>&quot;T&quot;</code> then this is <code>&quot;T&quot;</code>, if the kind is empty then this is <code>&quot;object&quot;</code>. See also <a href="Sort/index.html#val-or_kind"><code>Sort.or_kind</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-doc"><a href="#val-doc" class="anchor"></a><code><span><span class="keyword">val</span> doc : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>doc t</code> is a documentation string for the JSON values typed by <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_doc"><a href="#val-with_doc" class="anchor"></a><code><span><span class="keyword">val</span> with_doc : <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>with_doc ?kind ?doc t</code> is <code>t</code> with its <a href="#val-doc"><code>doc</code></a> or <a href="#val-kind"><code>kind</code></a> updated to the corresponding values if specified.</p></div></div><h2 id="base"><a href="#base" class="anchor"></a>Base types</h2><p>Read the <span class="xref-unresolved" title="cookbook.base_types">cookbook</span> on base types.</p><div class="odoc-spec"><div class="spec module anchored" id="module-Base"><a href="#module-Base" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Base/index.html">Base</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Mapping JSON base types.</p></div></div><h3 id="option"><a href="#option" class="anchor"></a>Nulls and options</h3><p>Read the <span class="xref-unresolved" title="cookbook.dealing_with_null">cookbook</span> on <code>null</code>s.</p><div class="odoc-spec"><div class="spec value anchored" id="val-null"><a href="#val-null" class="anchor"></a><code><span><span class="keyword">val</span> null : <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>null v</code> maps JSON nulls to <code>v</code>. On encodes any value of type <code>'a</code> is encoded by null. <code>doc</code> and <code>kind</code> are given to the underlying <a href="Base/index.html#type-map"><code>Base.map</code></a>. See also <a href="Base/index.html#val-null"><code>Base.null</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-none"><a href="#val-none" class="anchor"></a><code><span><span class="keyword">val</span> none : <span><span><span class="type-var">'a</span> option</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>none</code> maps JSON nulls to <code>None</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-some"><a href="#val-some" class="anchor"></a><code><span><span class="keyword">val</span> some : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> option</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>some t</code> maps JSON like <code>t</code> does but wraps results in <code>Some</code>. Encoding fails if the value is <code>None</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-option"><a href="#val-option" class="anchor"></a><code><span><span class="keyword">val</span> option : <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> option</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>option t</code> maps JSON nulls to <code>None</code> and other values by <code>t</code>. <code>doc</code> and <code>kind</code> are given to the underlying <a href="#val-any"><code>any</code></a> map.</p></div></div><h3 id="booleans"><a href="#booleans" class="anchor"></a>Booleans</h3><div class="odoc-spec"><div class="spec value anchored" id="val-bool"><a href="#val-bool" class="anchor"></a><code><span><span class="keyword">val</span> bool : <span>bool <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>bool</code> maps JSON booleans to <code>bool</code> values. See also <a href="Base/index.html#val-bool"><code>Base.bool</code></a>.</p></div></div><h3 id="numbers"><a href="#numbers" class="anchor"></a>Numbers</h3><p>Read the <span class="xref-unresolved" title="cookbook.dealing_with_numbers">cookbook</span> on JSON numbers and their many pitfalls.</p><div class="odoc-spec"><div class="spec value anchored" id="val-number"><a href="#val-number" class="anchor"></a><code><span><span class="keyword">val</span> number : <span>float <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>number</code> maps JSON nulls or numbers to <code>float</code> values. On decodes JSON null is mapped to <a href="../../../stdlib/Stdlib/Float/index.html#val-nan"><code>Float.nan</code></a>. On encodes any <a href="../../../stdlib/Stdlib/Float/index.html#val-is_finite" title="Float.is_finite">non-finite</a> float is lossily mapped to JSON null (<span class="xref-unresolved" title="cookbook.non_finite_numbers">explanation</span>). See also <a href="Base/index.html#val-number"><code>Base.number</code></a>, <a href="#val-any_float"><code>any_float</code></a> and the integer combinators below.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-any_float"><a href="#val-any_float" class="anchor"></a><code><span><span class="keyword">val</span> any_float : <span>float <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>any_float</code> is a lossless representation for IEEE 754 doubles. It maps <a href="../../../stdlib/Stdlib/Float/index.html#val-is_finite" title="Float.is_finite">non-finite</a> floats by the JSON strings defined by <a href="../../../stdlib/Stdlib/Float/index.html#val-to_string"><code>Float.to_string</code></a>. This contrasts with <a href="#val-number"><code>number</code></a> which maps them to JSON null values (<span class="xref-unresolved" title="cookbook.non_finite_numbers">explanation</span>). Note that on decodes this still maps JSON nulls to <a href="../../../stdlib/Stdlib/Float/index.html#val-nan"><code>Float.nan</code></a> and any successful string decode of <a href="../../../stdlib/Stdlib/Float/index.html#val-of_string_opt"><code>Float.of_string_opt</code></a> (so numbers can also be written as strings). See also <a href="#val-number"><code>number</code></a>.</p><p><b>Warning.</b> <code>any_float</code> should only be used between parties that have agreed on such an encoding. To maximize interoperability you should use the lossy <a href="#val-number"><code>number</code></a> map.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-float_as_hex_string"><a href="#val-float_as_hex_string" class="anchor"></a><code><span><span class="keyword">val</span> float_as_hex_string : <span>float <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>float_as_hex_string</code> maps JSON strings made of IEEE 754 doubles in hex notation to float values. On encodes strings this uses the <code>&quot;%h&quot;</code> format string. On decodes it accepts anything sucessfully decoded by <a href="../../../stdlib/Stdlib/Float/index.html#val-of_string_opt"><code>Float.of_string_opt</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-uint8"><a href="#val-uint8" class="anchor"></a><code><span><span class="keyword">val</span> uint8 : <span>int <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>uint8</code> maps JSON numbers to unsigned 8-bit integers. JSON numbers are sucessfully decoded if after truncation they can be represented on the [0;255] range. Encoding errors if the integer is out of range.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-uint16"><a href="#val-uint16" class="anchor"></a><code><span><span class="keyword">val</span> uint16 : <span>int <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>uint16</code> maps JSON numbers to unsigned 16-bit integers. JSON numbers are sucessfully decoded if after truncation they can be represented on the [0;65535] range. Encoding errors if the integer is out of range.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-int8"><a href="#val-int8" class="anchor"></a><code><span><span class="keyword">val</span> int8 : <span>int <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>int8</code> maps JSON numbers to 8-bit integers. JSON numbers are sucessfully decoded if after truncation they can be represented on the [-128;127] range. Encoding errors if the integer is out of range.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-int16"><a href="#val-int16" class="anchor"></a><code><span><span class="keyword">val</span> int16 : <span>int <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>int16</code> maps JSON numbers to 16-bit integers. JSON numbers are sucessfully decoded if after truncation they can be represented on the [-32768;32767] range. Encoding errors if the integer is out of range.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-int32"><a href="#val-int32" class="anchor"></a><code><span><span class="keyword">val</span> int32 : <span>int32 <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>int32</code> maps JSON numbers to 32-bit integers. JSON numbers are sucessfully decoded if after truncation they can be represented on the <code>int32</code> range, otherwise the decoder errors.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-int64"><a href="#val-int64" class="anchor"></a><code><span><span class="keyword">val</span> int64 : <span>int64 <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>int</code> maps truncated JSON numbers or JSON strings to 64-bit integers.</p><ul><li>JSON numbers are sucessfully decoded if after truncation they can be represented on the <code>int64</code> range, otherwise the decoder errors. <code>int64</code> values are encoded as JSON numbers if the integer is in the [-2<sup>53</sup>;2<sup>53</sup>] range.</li><li>JSON strings are decoded using <a href="../../../stdlib/Stdlib/index.html#val-int_of_string_opt"><code>int_of_string_opt</code></a>, this allows binary, octal, decimal and hex syntaxes and errors on overflow and syntax errors. <code>int</code> values are encoded as JSON strings with <a href="../../../stdlib/Stdlib/Int/index.html#val-to_string"><code>Int.to_string</code></a> when the integer is outside the [-2<sup>53</sup>;2<sup>53</sup>] range</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-int64_as_string"><a href="#val-int64_as_string" class="anchor"></a><code><span><span class="keyword">val</span> int64_as_string : <span>int64 <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>int64_as_string</code> maps JSON strings to 64-bit integers. On decodes this uses <a href="../../../stdlib/Stdlib/Int64/index.html#val-of_string_opt"><code>Int64.of_string_opt</code></a> which allows binary, octal, decimal and hex syntaxes and errors on overflow and syntax errors. On encodes uses <a href="../../../stdlib/Stdlib/Int64/index.html#val-to_string"><code>Int64.to_string</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-int"><a href="#val-int" class="anchor"></a><code><span><span class="keyword">val</span> int : <span>int <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>int</code> maps truncated JSON numbers or JSON strings to <code>int</code> values.</p><ul><li>JSON numbers are sucessfully decoded if after truncation they can be represented on the <code>int</code> range, otherwise the decoder errors. <code>int</code> values are encoded as JSON numbers if the integer is in the [-2<sup>53</sup>;2<sup>53</sup>] range.</li><li>JSON strings are decoded using <a href="../../../stdlib/Stdlib/index.html#val-int_of_string_opt"><code>int_of_string_opt</code></a>, this allows binary, octal, decimal and hex syntaxes and errors on overflow and syntax errors. <code>int</code> values are encoded as JSON strings with <a href="../../../stdlib/Stdlib/Int/index.html#val-to_string"><code>Int.to_string</code></a> when the integer is outside the [-2<sup>53</sup>;2<sup>53</sup>] range</li></ul><p><b>Warning.</b> The behaviour of this function is platform dependent, it depends on the value of <a href="../../../stdlib/Stdlib/Sys/index.html#val-int_size"><code>Sys.int_size</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-int_as_string"><a href="#val-int_as_string" class="anchor"></a><code><span><span class="keyword">val</span> int_as_string : <span>int <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>int_as_string</code> maps JSON strings to <code>int</code> values. On decodes this uses <a href="../../../stdlib/Stdlib/index.html#val-int_of_string_opt"><code>int_of_string_opt</code></a> which allows binary, octal, decimal and hex syntaxes and errors on overflow and syntax errors. On encodes uses <a href="../../../stdlib/Stdlib/Int/index.html#val-to_string"><code>Int.to_string</code></a>.</p><p><b>Warning.</b> The behaviour of this function is platform dependent, it depends on the value of <a href="../../../stdlib/Stdlib/Sys/index.html#val-int_size"><code>Sys.int_size</code></a>.</p></div></div><h3 id="enums"><a href="#enums" class="anchor"></a>Strings and enums</h3><p>Read the <span class="xref-unresolved" title="cookbook.transform_strings">cookbook</span> on transforming strings.</p><div class="odoc-spec"><div class="spec value anchored" id="val-string"><a href="#val-string" class="anchor"></a><code><span><span class="keyword">val</span> string : <span>string <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>string</code> maps unescaped JSON strings to UTF-8 encoded <code>string</code> values. See also <a href="Base/index.html#val-string"><code>Base.string</code></a>.</p><p><b>Warning.</b> Encoders assume OCaml <code>string</code>s have been checked for UTF-8 validity.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-of_of_string"><a href="#val-of_of_string" class="anchor"></a><code><span><span class="keyword">val</span> of_of_string : 
  <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?enc</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> string)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, string)</span> <a href="../../../stdlib/Stdlib/index.html#type-result">result</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>of_of_string of_string</code> maps JSON string with a <a href="Base/index.html#type-map" title="Base.map">base map</a> using <code>of_string</code> for decoding and <code>enc</code> for encoding. See the <span class="xref-unresolved" title="cookbook.transform_strings">cookbook</span>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-enum"><a href="#val-enum" class="anchor"></a><code><span><span class="keyword">val</span> enum : 
  <span><span class="optlabel">?cmp</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> int)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(string * <span class="type-var">'a</span>)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>enum assoc</code> maps JSON strings member of the <code>assoc</code> list to the corresponding OCaml value and vice versa in log(n). <code>cmp</code> is used to compare the OCaml values, it defaults to <a href="../../../stdlib/Stdlib/index.html#val-compare"><code>Stdlib.compare</code></a>. Decoding and encoding errors on strings or values not part of <code>assoc</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-binary_string"><a href="#val-binary_string" class="anchor"></a><code><span><span class="keyword">val</span> binary_string : <span>string <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>binary_string</code> maps JSON strings made of an even number of hexdecimal US-ASCII upper or lower case digits to the corresponding byte sequence. On encoding uses only lower case hexadecimal digits to encode the byte sequence.</p></div></div><h2 id="arrays"><a href="#arrays" class="anchor"></a>Arrays and tuples</h2><p>Read the <span class="xref-unresolved" title="cookbook.dealing_with_arrays">cookbok</span> on arrays and see also <a href="#array_queries" title="array_queries">array queries and updates</a>.</p><div class="odoc-spec"><div class="spec module anchored" id="module-Array"><a href="#module-Array" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Array/index.html">Array</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Mapping JSON arrays.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-list"><a href="#val-list" class="anchor"></a><code><span><span class="keyword">val</span> list : <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>list t</code> maps JSON arrays of type <code>t</code> to <code>list</code> values. See also <a href="Array/index.html#val-list_map"><code>Array.list_map</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-array"><a href="#val-array" class="anchor"></a><code><span><span class="keyword">val</span> array : <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> array</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>array t</code> maps JSON arrays of type <code>t</code> to <code>array</code> values. See also <a href="Array/index.html#val-array_map"><code>Array.array_map</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-array_as_string_map"><a href="#val-array_as_string_map" class="anchor"></a><code><span><span class="keyword">val</span> array_as_string_map : 
  <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">key</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> string)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../../../stdlib/Stdlib/Map/Make/index.html#type-t">Map.Make(String).t</a></span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>array_as_string_map ~key t</code> maps JSON array elements of type <code>t</code> to string maps by indexing them with <code>key</code>. If two elements have the same <code>key</code> the element with the greatest index takes over. Elements of the map are encoded to a JSON array in (binary) key order.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bigarray"><a href="#val-bigarray" class="anchor"></a><code><span><span class="keyword">val</span> bigarray : 
  <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="../../../stdlib/Stdlib/Bigarray/index.html#type-kind">Bigarray.kind</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>, <a href="../../../stdlib/Stdlib/Bigarray/index.html#type-c_layout">Bigarray.c_layout</a>)</span> <a href="../../../stdlib/Stdlib/Bigarray/Array1/index.html#type-t">Bigarray.Array1.t</a></span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>bigarray k t</code> maps JSON arrays of type <code>t</code> to <code>Bigarray.Array1.t</code> values. See also <a href="Array/index.html#val-bigarray_map"><code>Array.bigarray_map</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-t2"><a href="#val-t2" class="anchor"></a><code><span><span class="keyword">val</span> t2 : 
  <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dec</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'t2</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?enc</span>:<span>(<span><span class="type-var">'t2</span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'t2</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>t2 ?dec ?enc t</code> maps JSON arrays with exactly 2 elements of type <code>t</code> to value of type <code>'t2</code>. Decodes error if there are more elements. <code>enc v i</code> must return the zero-based <code>i</code>th element.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-t3"><a href="#val-t3" class="anchor"></a><code><span><span class="keyword">val</span> t3 : 
  <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dec</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'t3</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?enc</span>:<span>(<span><span class="type-var">'t3</span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'t3</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>t3</code> is like <a href="#val-t2"><code>t2</code></a> but for 3 elements.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-t4"><a href="#val-t4" class="anchor"></a><code><span><span class="keyword">val</span> t4 : 
  <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dec</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'t4</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?enc</span>:<span>(<span><span class="type-var">'t4</span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'t4</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>t4</code> is like <a href="#val-t2"><code>t2</code></a> but for 4 elements.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tn"><a href="#val-tn" class="anchor"></a><code><span><span class="keyword">val</span> tn : <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="label">n</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> array</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>tn ~n t</code> maps JSON arrays of exactly <code>n</code> elements of type <code>t</code> to <code>array</code> values. This is <a href="#val-array"><code>array</code></a> limited by <code>n</code>.</p></div></div><h2 id="objects"><a href="#objects" class="anchor"></a>Objects</h2><p>Read the <span class="xref-unresolved" title="cookbook.dealing_with_objects">cookbook</span> on objects. See a <span class="xref-unresolved" title="cookbook.objects_as_records">simple example</span>. See also <a href="#object_queries" title="object_queries">object queries and updates</a>.</p><div class="odoc-spec"><div class="spec module anchored" id="module-Object"><a href="#module-Object" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Object/index.html">Object</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Mapping JSON objects.</p></div></div><h2 id="any"><a href="#any" class="anchor"></a>Any</h2><div class="odoc-spec"><div class="spec value anchored" id="val-any"><a href="#val-any" class="anchor"></a><code><span><span class="keyword">val</span> any : 
  <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dec_null</span>:<span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dec_bool</span>:<span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dec_number</span>:<span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dec_string</span>:<span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dec_array</span>:<span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dec_object</span>:<span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?enc</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>any ()</code> maps subsets of JSON value of different sorts to values of type <code>'a</code>. The unspecified cases are not part of the subset and error on decoding. <code>enc</code> selects the type to use on encoding and errors if omitted. <code>kind</code> names the entities represented by the type and <code>doc</code> documents them, both defaults to <code>&quot;&quot;</code>.</p></div></div><h2 id="maps"><a href="#maps" class="anchor"></a>Maps &amp; recursion</h2><div class="odoc-spec"><div class="spec value anchored" id="val-map"><a href="#val-map" class="anchor"></a><code><span><span class="keyword">val</span> map : 
  <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dec</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?enc</span>:<span>(<span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>map t</code> changes the type of <code>t</code> from <code>'a</code> to <code>'b</code>.</p><ul><li><code>kind</code> names the entities represented by the type and <code>doc</code> documents them, both default to <code>&quot;&quot;</code>.</li><li><code>dec</code> decodes values of type <code>'a</code> to values of type <code>'b</code>. Can be omitted if the result is only used for encoding. The default errors.</li><li><code>enc</code> encodes values of type <code>'b</code> to values of type <code>'a</code>. Can be omitted if the result is only used for decoding. The default errors.</li></ul><p>For mapping base types use <a href="Base/index.html#type-map"><code>Jsont.Base.map</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-iter"><a href="#val-iter" class="anchor"></a><code><span><span class="keyword">val</span> iter : 
  <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dec</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?enc</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>iter ?enc dec t</code> applies <code>dec</code> on decoding and <code>enc</code> on encoding but otherwise behaves like <code>t</code> does. Typically <code>dec</code> can be used to further assert the shape of the decoded value and <a href="Error/index.html#val-msgf"><code>Error.msgf</code></a> if it hasn't the right shape. <code>iter</code> can also be used as a tracing facility for debugging.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-rec'"><a href="#val-rec'" class="anchor"></a><code><span><span class="keyword">val</span> rec' : <span><span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <a href="../../../stdlib/Stdlib/Lazy/index.html#type-t">Lazy.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>rec'</code> maps recursive JSON values. See the <span class="xref-unresolved" title="cookbook.recursion">cookbook</span>.</p></div></div><h2 id="ignoring"><a href="#ignoring" class="anchor"></a>Ignoring</h2><div class="odoc-spec"><div class="spec value anchored" id="val-ignore"><a href="#val-ignore" class="anchor"></a><code><span><span class="keyword">val</span> ignore : <span>unit <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>ignore</code> lossily maps all JSON values to <code>()</code> on decoding and errors on encoding. See also <a href="#val-const"><code>const</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-zero"><a href="#val-zero" class="anchor"></a><code><span><span class="keyword">val</span> zero : <span>unit <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>zero</code> lossily maps all JSON values to <code>()</code> on decoding and encodes JSON nulls.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-todo"><a href="#val-todo" class="anchor"></a><code><span><span class="keyword">val</span> todo : <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?dec_stub</span>:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>todo ?dec_stub ()</code> maps all JSON values to <code>dec_stub</code> if specified (errors otherwise) and errors on encoding.</p></div></div><h2 id="generic_json"><a href="#generic_json" class="anchor"></a>Generic JSON</h2><div class="odoc-spec"><div class="spec type anchored" id="type-name"><a href="#type-name" class="anchor"></a><code><span><span class="keyword">type</span> name</span><span> = <span>string <a href="#type-node">node</a></span></span></code></div><div class="spec-doc"><p>The type for JSON member names.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-mem"><a href="#type-mem" class="anchor"></a><code><span><span class="keyword">type</span> mem</span><span> = <a href="#type-name">name</a> * <a href="#type-json">json</a></span></code></div><div class="spec-doc"><p>The type for generic JSON object members.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-object'"><a href="#type-object'" class="anchor"></a><code><span><span class="keyword">and</span> object'</span><span> = <span><a href="#type-mem">mem</a> list</span></span></code></div><div class="spec-doc"><p>The type for generic JSON objects.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-json"><a href="#type-json" class="anchor"></a><code><span><span class="keyword">and</span> json</span><span> = </span></code><ol><li id="type-json.Null" class="def variant constructor anchored"><a href="#type-json.Null" class="anchor"></a><code><span>| </span><span><span class="constructor">Null</span> <span class="keyword">of</span> <span>unit <a href="#type-node">node</a></span></span></code></li><li id="type-json.Bool" class="def variant constructor anchored"><a href="#type-json.Bool" class="anchor"></a><code><span>| </span><span><span class="constructor">Bool</span> <span class="keyword">of</span> <span>bool <a href="#type-node">node</a></span></span></code></li><li id="type-json.Number" class="def variant constructor anchored"><a href="#type-json.Number" class="anchor"></a><code><span>| </span><span><span class="constructor">Number</span> <span class="keyword">of</span> <span>float <a href="#type-node">node</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Encoders must use <code>Null</code> if float is <a href="../../../stdlib/Stdlib/Float/index.html#val-is_finite" title="Float.is_finite">not finite</a>.</p><span class="comment-delim">*)</span></div></li><li id="type-json.String" class="def variant constructor anchored"><a href="#type-json.String" class="anchor"></a><code><span>| </span><span><span class="constructor">String</span> <span class="keyword">of</span> <span>string <a href="#type-node">node</a></span></span></code></li><li id="type-json.Array" class="def variant constructor anchored"><a href="#type-json.Array" class="anchor"></a><code><span>| </span><span><span class="constructor">Array</span> <span class="keyword">of</span> <span><span><a href="#type-json">json</a> list</span> <a href="#type-node">node</a></span></span></code></li><li id="type-json.Object" class="def variant constructor anchored"><a href="#type-json.Object" class="anchor"></a><code><span>| </span><span><span class="constructor">Object</span> <span class="keyword">of</span> <span><a href="#type-object'">object'</a> <a href="#type-node">node</a></span></span></code></li></ol></div><div class="spec-doc"><p>The type for generic JSON values.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Json"><a href="#module-Json" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Json/index.html">Json</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Generic JSON values.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-json"><a href="#val-json" class="anchor"></a><code><span><span class="keyword">val</span> json : <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>json</code> maps any JSON value to its generic representation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-json_null"><a href="#val-json_null" class="anchor"></a><code><span><span class="keyword">val</span> json_null : <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>json_null</code> maps JSON nulls to their generic representation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-json_bool"><a href="#val-json_bool" class="anchor"></a><code><span><span class="keyword">val</span> json_bool : <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>json_bool</code> maps JSON booleans to their generic representation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-json_number"><a href="#val-json_number" class="anchor"></a><code><span><span class="keyword">val</span> json_number : <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>json_number</code> maps JSON nulls or numbers (<span class="xref-unresolved" title="cookbook.non_finite_numbers">explanation</span>) to their generic representation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-json_string"><a href="#val-json_string" class="anchor"></a><code><span><span class="keyword">val</span> json_string : <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>json_string</code> represents JSON strings by their generic representation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-json_array"><a href="#val-json_array" class="anchor"></a><code><span><span class="keyword">val</span> json_array : <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>json_array</code> represents JSON arrays by their generic representation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-json_object"><a href="#val-json_object" class="anchor"></a><code><span><span class="keyword">val</span> json_object : <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>json_object</code> represents JSON objects by their generic representation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-json_mems"><a href="#val-json_mems" class="anchor"></a><code><span><span class="keyword">val</span> json_mems : <span><span>(<a href="#type-json">json</a>, <a href="#type-json">json</a>, <span><a href="#type-mem">mem</a> list</span>)</span> <a href="Object/Mems/index.html#type-map">Object.Mems.map</a></span></span></code></div><div class="spec-doc"><p><code>json_mems</code> is a members map collecting unknown members into a generic JSON object. See <span class="xref-unresolved" title="cookbook.keeping">this example</span>.</p></div></div><h2 id="queries"><a href="#queries" class="anchor"></a>Queries and updates</h2><p>Queries are lossy or aggregating decodes. Updates decode to <a href="#type-json"><code>json</code></a> values but transform the data along the way. They allow to process JSON data without having to fully model it (see the update example in the <span class="xref-unresolved" title="index.quick_start">quick start</span>).</p><div class="odoc-spec"><div class="spec value anchored" id="val-const"><a href="#val-const" class="anchor"></a><code><span><span class="keyword">val</span> const : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>const t v</code> maps any JSON value to <code>v</code> on decodes and unconditionally encodes <code>v</code> with <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-recode"><a href="#val-recode" class="anchor"></a><code><span><span class="keyword">val</span> recode : <span><span class="label">dec</span>:<span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">enc</span>:<span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>recode ~dec f ~enc</code> maps on decodes like <code>dec</code> does followed by <code>f</code> and on encodes uses <code>enc</code>. This can be used to change the JSON sort of value. For example:</p><pre class="language-ocaml"><code>recode ~dec:int (fun _ i -&gt; string_of_int s) ~enc:string</code></pre><p>decodes an integer but encodes the integer as a string.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update"><a href="#val-update" class="anchor"></a><code><span><span class="keyword">val</span> update : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>update t</code> decodes any JSON with <code>t</code> and directly encodes it back with <code>t</code> to yield the decode result. Encodes any JSON like <a href="#val-json"><code>json</code></a> does.</p></div></div><h3 id="array_queries"><a href="#array_queries" class="anchor"></a>Arrays</h3><div class="odoc-spec"><div class="spec value anchored" id="val-nth"><a href="#val-nth" class="anchor"></a><code><span><span class="keyword">val</span> nth : <span><span class="optlabel">?absent</span>:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>nth n t</code> decodes the <code>n</code>th index of a JSON array with <code>t</code>. Other indices are skipped. The decode errors if there is no such index unless <code>absent</code> is specified in which case this value is returned. Encodes a singleton array.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set_nth"><a href="#val-set_nth" class="anchor"></a><code><span><span class="keyword">val</span> set_nth : <span><span class="optlabel">?stub</span>:<a href="#type-json">json</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?allow_absent</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>set_nth t n v</code> on decodes sets the <code>n</code>th value of a JSON array to <code>v</code> encoded by <code>t</code>. Other indices are left untouched. Errors if there is no such index unless <code>~allow_absent:true</code> is specified in which case the index is created preceeded by as many <code>stub</code> indices as needed. <code>stub</code> defaults to <a href="Json/index.html#val-zero"><code>Json.zero</code></a> applied to the value <code>v</code> encoded by <code>t</code> (i.e. the &quot;natural zero&quot; of <code>v</code>'s encoding sort). Encodes like <a href="#val-json_array"><code>json_array</code></a> does.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update_nth"><a href="#val-update_nth" class="anchor"></a><code><span><span class="keyword">val</span> update_nth : <span><span class="optlabel">?stub</span>:<a href="#type-json">json</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?absent</span>:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>update_nth n t</code> on decode recodes the <code>n</code>th value of a JSON array with <code>t</code>. Errors if there is no such index unless <code>absent</code> is specified in which case the index is created with <code>absent</code>, encoded with <code>t</code> and preceeded by as many <code>stub</code> values as needed. <code>stub</code> defaults to <a href="Json/index.html#val-zero"><code>Json.zero</code></a> applied to the recode. Encodes like <a href="#val-json_array"><code>json_array</code></a> does.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-delete_nth"><a href="#val-delete_nth" class="anchor"></a><code><span><span class="keyword">val</span> delete_nth : <span><span class="optlabel">?allow_absent</span>:bool <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>delete_nth n</code> drops the <code>n</code>th index of a JSON array on both decode and encodes. Other indices are left untouched. Errors if there is no such index unless <code>~allow_absent:true</code> is specified in which case the data is left untouched.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-filter_map_array"><a href="#val-filter_map_array" class="anchor"></a><code><span><span class="keyword">val</span> filter_map_array : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>int <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> option</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>filter_map_array a b f</code> maps the <code>a</code> elements of a JSON array with <code>f</code> to <code>b</code> elements or deletes them on <code>None</code>. Encodes generic JSON arrays like <a href="#val-json_array"><code>json_array</code></a> does.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fold_array"><a href="#val-fold_array" class="anchor"></a><code><span><span class="keyword">val</span> fold_array : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>int <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>fold_array t f acc</code> fold <code>f</code> over the <code>t</code> elements of a JSON array starting with <code>acc</code>. Encodes an empty JSON array.</p></div></div><h3 id="object_queries"><a href="#object_queries" class="anchor"></a>Objects</h3><div class="odoc-spec"><div class="spec value anchored" id="val-mem"><a href="#val-mem" class="anchor"></a><code><span><span class="keyword">val</span> mem : <span><span class="optlabel">?absent</span>:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>mem name t</code> decodes the member named <code>name</code> of a JSON object with <code>t</code>. Other members are skipped. The decode errors if there is no such member unless <code>absent</code> is specified in which case this value is returned. Encodes an object with a single <code>name</code> member.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set_mem"><a href="#val-set_mem" class="anchor"></a><code><span><span class="keyword">val</span> set_mem : <span><span class="optlabel">?allow_absent</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>set_mem t name v</code> sets the member value of <code>name</code> of a <code>JSON</code> object to an encoding of <code>v</code> with <code>t</code>. This happens both on decodes and encodes. Errors if there is no such member unless <code>allow_absent:true</code> is specified in which case a member is added to the object.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update_mem"><a href="#val-update_mem" class="anchor"></a><code><span><span class="keyword">val</span> update_mem : <span><span class="optlabel">?absent</span>:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>update_mem name t</code> recodes the member value of <code>name</code> of a JSON object with <code>t</code>. This happens both on decodes and encodes. Errors if there is no such member unless <code>absent</code> is specified in which case a member with this value encoded with <code>t</code> is added to the object.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-delete_mem"><a href="#val-delete_mem" class="anchor"></a><code><span><span class="keyword">val</span> delete_mem : <span><span class="optlabel">?allow_absent</span>:bool <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>delete_mem name</code> deletes the member named <code>name</code> of a JSON object on decode. Other members are left untouched. The decode errors if there is no such member unless <code>~allow_absent:true</code> is specified in which case the data is left untouched. Encodes generic JSON objects like <a href="#val-json_object"><code>json_object</code></a> does.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-filter_map_object"><a href="#val-filter_map_object" class="anchor"></a><code><span><span class="keyword">val</span> filter_map_object : 
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="Meta/index.html#type-t">Meta.t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="#type-name">name</a> * <span class="type-var">'b</span>)</span> option</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>filter_map_object a b f</code> maps the <code>a</code> members of a JSON object with <code>f</code> to <code>(n, b)</code> members or deletes them on <code>None</code>. The meta given to <code>f</code> is the meta of the member name. Encodes generic JSON arrays like <a href="#val-json_object"><code>json_object</code></a> does.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fold_object"><a href="#val-fold_object" class="anchor"></a><code><span><span class="keyword">val</span> fold_object : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="Meta/index.html#type-t">Meta.t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>fold_object t f acc</code> folds <code>f</code> over the <code>t</code> members of a JSON object starting with <code>acc</code>. Encodes an empty JSON object.</p></div></div><h3 id="index_queries"><a href="#index_queries" class="anchor"></a>Indices</h3><div class="odoc-spec"><div class="spec value anchored" id="val-index"><a href="#val-index" class="anchor"></a><code><span><span class="keyword">val</span> index : <span><span class="optlabel">?absent</span>:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="Path/index.html#type-index">Path.index</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>index</code> uses <a href="#val-nth"><code>nth</code></a> or <a href="#val-mem"><code>mem</code></a> on the given index.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set_index"><a href="#val-set_index" class="anchor"></a><code><span><span class="keyword">val</span> set_index : <span><span class="optlabel">?allow_absent</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="Path/index.html#type-index">Path.index</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>set_index</code> uses <a href="#val-set_nth"><code>set_nth</code></a> or <a href="#val-set_mem"><code>set_mem</code></a> on the given index.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update_index"><a href="#val-update_index" class="anchor"></a><code><span><span class="keyword">val</span> update_index : <span><span class="optlabel">?stub</span>:<a href="#type-json">json</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?absent</span>:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="Path/index.html#type-index">Path.index</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>update_index</code> uses <a href="#val-update_nth"><code>update_nth</code></a> or <a href="#val-update_mem"><code>update_mem</code></a> on the given index.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-delete_index"><a href="#val-delete_index" class="anchor"></a><code><span><span class="keyword">val</span> delete_index : <span><span class="optlabel">?allow_absent</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="Path/index.html#type-index">Path.index</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>delete_index</code> uses <a href="#val-delete_nth"><code>delete_nth</code></a> or <a href="#val-delete_mem"><code>delete_mem</code></a> on the given index.</p></div></div><h3 id="path_queries"><a href="#path_queries" class="anchor"></a>Paths</h3><div class="odoc-spec"><div class="spec value anchored" id="val-path"><a href="#val-path" class="anchor"></a><code><span><span class="keyword">val</span> path : <span><span class="optlabel">?absent</span>:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="Path/index.html#type-t">Path.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>path p t</code> <a href="#val-index" title="index">decodes</a> with <code>t</code> on the last index of <code>p</code>. If <code>p</code> is <a href="Path/index.html#val-root"><code>Path.root</code></a> this is <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set_path"><a href="#val-set_path" class="anchor"></a><code><span><span class="keyword">val</span> set_path : 
  <span><span class="optlabel">?stub</span>:<a href="#type-json">json</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?allow_absent</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="Path/index.html#type-t">Path.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>set_path t p v</code> <a href="#val-set_index" title="set_index">sets</a> the last index of <code>p</code>. If <code>p</code> is <a href="Path/index.html#val-root"><code>Path.root</code></a> this encodes <code>v</code> with <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update_path"><a href="#val-update_path" class="anchor"></a><code><span><span class="keyword">val</span> update_path : <span><span class="optlabel">?stub</span>:<a href="#type-json">json</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?absent</span>:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="Path/index.html#type-t">Path.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>update_path p t</code> <a href="#val-update_index" title="update_index">updates</a> the last index of <code>p</code> with <code>t</code>. On the root path this is <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-delete_path"><a href="#val-delete_path" class="anchor"></a><code><span><span class="keyword">val</span> delete_path : <span><span class="optlabel">?allow_absent</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="Path/index.html#type-t">Path.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-json">json</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>delete_path p</code> <a href="#val-delete_index" title="delete_index">deletes</a> the last index of <code>p</code>. If <code>p</code> is <a href="Path/index.html#val-root"><code>Path.root</code></a> this is <a href="Json/index.html#val-null"><code>Json.null</code></a>.</p></div></div><h2 id="fmt"><a href="#fmt" class="anchor"></a>Formatting</h2><div class="odoc-spec"><div class="spec type anchored" id="type-format"><a href="#type-format" class="anchor"></a><code><span><span class="keyword">type</span> format</span><span> = </span></code><ol><li id="type-format.Minify" class="def variant constructor anchored"><a href="#type-format.Minify" class="anchor"></a><code><span>| </span><span><span class="constructor">Minify</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Compact. No whitespace, no newlines.</p><span class="comment-delim">*)</span></div></li><li id="type-format.Indent" class="def variant constructor anchored"><a href="#type-format.Indent" class="anchor"></a><code><span>| </span><span><span class="constructor">Indent</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Indented output (not necessarily pretty).</p><span class="comment-delim">*)</span></div></li><li id="type-format.Layout" class="def variant constructor anchored"><a href="#type-format.Layout" class="anchor"></a><code><span>| </span><span><span class="constructor">Layout</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Follow <a href="Meta/index.html"><code>Meta</code></a> layout information.</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>The type for specifying JSON encoding formatting. See for example <code>Jsont_bytesrw.encode</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-number_format"><a href="#type-number_format" class="anchor"></a><code><span><span class="keyword">type</span> number_format</span><span> = <span><span>(<span>float <span class="arrow">&#45;&gt;</span></span> unit, <a href="../../../stdlib/Stdlib/Format/index.html#type-formatter">Format.formatter</a>, unit)</span> <a href="../../../stdlib/Stdlib/index.html#type-format">format</a></span></span></code></div><div class="spec-doc"><p>The type for JSON number formatters.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_number_format"><a href="#val-default_number_format" class="anchor"></a><code><span><span class="keyword">val</span> default_number_format : <a href="#type-number_format">number_format</a></span></code></div><div class="spec-doc"><p><code>default_number_format</code> is <code>&quot;%.17g&quot;</code>. This number formats ensures that finite floating point values can be interchanged without loss of precision.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_null"><a href="#val-pp_null" class="anchor"></a><code><span><span class="keyword">val</span> pp_null : <span>unit <a href="#type-fmt">fmt</a></span></span></code></div><div class="spec-doc"><p><code>pp_null</code> formats a JSON null.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_bool"><a href="#val-pp_bool" class="anchor"></a><code><span><span class="keyword">val</span> pp_bool : <span>bool <a href="#type-fmt">fmt</a></span></span></code></div><div class="spec-doc"><p><code>pp_bool</code> formats a JSON bool.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_number"><a href="#val-pp_number" class="anchor"></a><code><span><span class="keyword">val</span> pp_number : <span>float <a href="#type-fmt">fmt</a></span></span></code></div><div class="spec-doc"><p><code>pp_number</code> formats a JSON number of a JSON null if the float is not finite. Uses the <a href="#val-default_number_format"><code>default_number_format</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_number'"><a href="#val-pp_number'" class="anchor"></a><code><span><span class="keyword">val</span> pp_number' : <span><a href="#type-number_format">number_format</a> <span class="arrow">&#45;&gt;</span></span> <span>float <a href="#type-fmt">fmt</a></span></span></code></div><div class="spec-doc"><p><code>pp_number fmt</code> is like <a href="#val-pp_number"><code>pp_number</code></a> but uses <code>fmt</code> to format the number.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_string"><a href="#val-pp_string" class="anchor"></a><code><span><span class="keyword">val</span> pp_string : <span>string <a href="#type-fmt">fmt</a></span></span></code></div><div class="spec-doc"><p><code>pp_string</code> formats a JSON string (quoted and escaped). Assumes the string is valid UTF-8.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_json"><a href="#val-pp_json" class="anchor"></a><code><span><span class="keyword">val</span> pp_json : <span><a href="#type-json">json</a> <a href="#type-fmt">fmt</a></span></span></code></div><div class="spec-doc"><p><code>pp_json</code> formats JSON, see <a href="#val-pp_json'"><code>pp_json'</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_json'"><a href="#val-pp_json'" class="anchor"></a><code><span><span class="keyword">val</span> pp_json' : <span><span class="optlabel">?number_format</span>:<a href="#type-number_format">number_format</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-json">json</a> <a href="#type-fmt">fmt</a></span></span></code></div><div class="spec-doc"><p><code>pp' ~format ~number_format () ppf j</code> formats <code>j</code> on <code>ppf</code>. The output is indented but may be more compact than an <code>Indent</code> JSON encoder may do. For example arrays may be output on one line if they fit etc.</p><ul><li><code>number_format</code> is used to format JSON numbers. Defaults to <a href="#val-default_number_format"><code>default_number_format</code></a></li><li>Non-finite numbers are output as JSON nulls (<span class="xref-unresolved" title="cookbook.non_finite_numbers">explanation</span>).</li><li>Strings are assumed to be valid UTF-8.</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_value"><a href="#val-pp_value" class="anchor"></a><code><span><span class="keyword">val</span> pp_value : <span><span class="optlabel">?number_format</span>:<a href="#type-number_format">number_format</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-fmt">fmt</a></span></span></code></div><div class="spec-doc"><p><code>pp_value t ()</code> formats the JSON representation of values as described by <code>t</code> by encoding it with <a href="Json/index.html#val-encode"><code>Json.encode</code></a> and formatting it with <a href="#val-pp_json'"><code>pp_json'</code></a>. If the encoding of the value errors a JSON string with the error message is formatted. This means that <a href="#val-pp_value"><code>pp_value</code></a> should always format valid JSON text.</p></div></div><h2 id="low"><a href="#low" class="anchor"></a>Low-level representation</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Repr"><a href="#module-Repr" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Repr/index.html">Repr</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Low level representation (unstable).</p></div></div></div></body></html>
