<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Repr (docs.findlib-1.jsont.Jsont.Repr)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../../index.html">Index</a> &#x00BB; <a href="../../../../index.html">docs</a> &#x00BB; <a href="../../../index.html">findlib-1</a> &#x00BB; <a href="../../index.html">jsont</a> &#x00BB; <a href="../index.html">Jsont</a> &#x00BB; Repr</nav><header class="odoc-preamble"><h1>Module <code><span>Jsont.Repr</span></code></h1><p>Low level representation (unstable).</p><p>This representation may change even between minor versions of the library. It can be used to devise new processors on JSON types.</p><p>Processors should be ready to catch the <a href="../index.html#exception-Error"><code>Jsont.Error</code></a> exception when they invoke functional members of the representation.</p><p>Processors should make sure they interpret mappings correctly. In particular:</p><ul><li>The <code>Number</code> case represents the sets of JSON numbers and nulls.</li></ul><p>See the source of <a href="../Json/index.html#val-decode'"><code>Json.decode'</code></a> and <a href="../Json/index.html#val-encode'"><code>Json.encode'</code></a> for a simple example on how to process this representation. The <a href="https://erratique.ch/repos/jsont/tree/paper">paper</a> in the Jsont source repository may also help to understand this menagerie of types.</p></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#base">Base value maps</a></li><li><a href="#types">JSON types</a></li><li><a href="#array">Array maps</a></li><li><a href="#object_map">Object maps</a><ul><li><a href="#unknown_mems">Unknown members</a></li><li><a href="#case_objects">Case objects</a></li></ul></li><li><a href="#any">Any maps</a></li><li><a href="#type_map">Type maps</a></li><li><a href="#conv">Convert</a></li><li><a href="#kinds">Kinds and doc</a></li><li><a href="#errors">Errors</a></li><li><a href="#toolbox">Processor toolbox</a></li></ul></nav></div><div class="odoc-content"><div class="odoc-spec"><div class="spec type subst anchored" id="type-t'"><a href="#type-t'" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t'</span></span><span> := <span><span class="type-var">'a</span> <a href="../index.html#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-String_map"><a href="#module-String_map" class="anchor"></a><code><span><span class="keyword">module</span> <a href="String_map/index.html">String_map</a></span><span> : <a href="../../../../stdlib/Stdlib/Map/module-type-S/index.html">Map.S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../../../../stdlib/Stdlib/Map/module-type-S/index.html#type-key">key</a> = string</span></span></code></div><div class="spec-doc"><p>A <code>Map.Make(String)</code> instance.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Type"><a href="#module-Type" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Type/index.html">Type</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Type identifiers. Can be removed once we require OCaml 5.1</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-dec_fun"><a href="#type-dec_fun" class="anchor"></a><code><span><span class="keyword">type</span> <span>('ret, 'f) dec_fun</span></span><span> = </span></code><ol><li id="type-dec_fun.Dec_fun" class="def variant constructor anchored"><a href="#type-dec_fun.Dec_fun" class="anchor"></a><code><span>| </span><span><span class="constructor">Dec_fun</span> : <span class="type-var">'f</span> <span class="arrow">&#45;&gt;</span> <span><span>(<span class="type-var">'ret</span>, <span class="type-var">'f</span>)</span> <a href="#type-dec_fun">dec_fun</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The function and its return type.</p><span class="comment-delim">*)</span></div></li><li id="type-dec_fun.Dec_app" class="def variant constructor anchored"><a href="#type-dec_fun.Dec_app" class="anchor"></a><code><span>| </span><span><span class="constructor">Dec_app</span> : <span><span>(<span class="type-var">'ret</span>, <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <a href="#type-dec_fun">dec_fun</a></span> * <span><span class="type-var">'a</span> <a href="Type/Id/index.html#type-t">Type.Id.t</a></span> <span class="arrow">&#45;&gt;</span> <span><span>(<span class="type-var">'ret</span>, <span class="type-var">'b</span>)</span> <a href="#type-dec_fun">dec_fun</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Application of an argument to a function witnessed by a type identifier. The type identifier can be used to lookup a value of the right type in an heterogenous dictionary.</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>The type for decoding functions.</p></div></div><h2 id="base"><a href="#base" class="anchor"></a>Base value maps</h2><div class="odoc-spec"><div class="spec type anchored" id="type-base_map"><a href="#type-base_map" class="anchor"></a><code><span><span class="keyword">type</span> <span>('a, 'b) base_map</span></span><span> = </span><span>{</span></code><ol><li id="type-base_map.kind" class="def record field anchored"><a href="#type-base_map.kind" class="anchor"></a><code><span>kind : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The kind of JSON value that are mapped (documentation)</p><span class="comment-delim">*)</span></div></li><li id="type-base_map.doc" class="def record field anchored"><a href="#type-base_map.doc" class="anchor"></a><code><span>doc : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>A doc string for the kind of JSON value.</p><span class="comment-delim">*)</span></div></li><li id="type-base_map.dec" class="def record field anchored"><a href="#type-base_map.dec" class="anchor"></a><code><span>dec : <span><a href="../Meta/index.html#type-t">Meta.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dec</code> decodes a base value represented by its metadata and <code>'a</code> to <code>'b</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-base_map.enc" class="def record field anchored"><a href="#type-base_map.enc" class="anchor"></a><code><span>enc : <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>enc</code> encodes a value of type <code>'b</code> to a base JSON value represented by <code>'a</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-base_map.enc_meta" class="def record field anchored"><a href="#type-base_map.enc_meta" class="anchor"></a><code><span>enc_meta : <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <a href="../Meta/index.html#type-t">Meta.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>enc_meta</code> recovers the base JSON value metadata from <code>'b</code> (if any).</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>The type for mapping JSON base values represented in OCaml by <code>'a</code> (these values are fixed by the cases in <a href="#type-t"><code>t</code></a>) to a value of type <code>'b</code>.</p></div></div><h2 id="types"><a href="#types" class="anchor"></a>JSON types</h2><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span><span> = </span></code><ol><li id="type-t.Null" class="def variant constructor anchored"><a href="#type-t.Null" class="anchor"></a><code><span>| </span><span><span class="constructor">Null</span> : <span><span>(unit, <span class="type-var">'a</span>)</span> <a href="#type-base_map">base_map</a></span> <span class="arrow">&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Null maps.</p><span class="comment-delim">*)</span></div></li><li id="type-t.Bool" class="def variant constructor anchored"><a href="#type-t.Bool" class="anchor"></a><code><span>| </span><span><span class="constructor">Bool</span> : <span><span>(bool, <span class="type-var">'a</span>)</span> <a href="#type-base_map">base_map</a></span> <span class="arrow">&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Boolean maps.</p><span class="comment-delim">*)</span></div></li><li id="type-t.Number" class="def variant constructor anchored"><a href="#type-t.Number" class="anchor"></a><code><span>| </span><span><span class="constructor">Number</span> : <span><span>(float, <span class="type-var">'a</span>)</span> <a href="#type-base_map">base_map</a></span> <span class="arrow">&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Number maps.</p><span class="comment-delim">*)</span></div></li><li id="type-t.String" class="def variant constructor anchored"><a href="#type-t.String" class="anchor"></a><code><span>| </span><span><span class="constructor">String</span> : <span><span>(string, <span class="type-var">'a</span>)</span> <a href="#type-base_map">base_map</a></span> <span class="arrow">&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>String maps.</p><span class="comment-delim">*)</span></div></li><li id="type-t.Array" class="def variant constructor anchored"><a href="#type-t.Array" class="anchor"></a><code><span>| </span><span><span class="constructor">Array</span> : <span><span>(<span class="type-var">'a</span>, <span class="type-var">'elt</span>, <span class="type-var">'builder</span>)</span> <a href="#type-array_map">array_map</a></span> <span class="arrow">&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Array maps.</p><span class="comment-delim">*)</span></div></li><li id="type-t.Object" class="def variant constructor anchored"><a href="#type-t.Object" class="anchor"></a><code><span>| </span><span><span class="constructor">Object</span> : <span><span>(<span class="type-var">'o</span>, <span class="type-var">'o</span>)</span> <a href="#type-object_map">object_map</a></span> <span class="arrow">&#45;&gt;</span> <span><span class="type-var">'o</span> <a href="#type-t">t</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Object maps.</p><span class="comment-delim">*)</span></div></li><li id="type-t.Any" class="def variant constructor anchored"><a href="#type-t.Any" class="anchor"></a><code><span>| </span><span><span class="constructor">Any</span> : <span><span class="type-var">'a</span> <a href="#type-any_map">any_map</a></span> <span class="arrow">&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Map for different sorts of JSON values.</p><span class="comment-delim">*)</span></div></li><li id="type-t.Map" class="def variant constructor anchored"><a href="#type-t.Map" class="anchor"></a><code><span>| </span><span><span class="constructor">Map</span> : <span><span>(<span class="type-var">'b</span>, <span class="type-var">'a</span>)</span> <a href="#type-map">map</a></span> <span class="arrow">&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Map from JSON type <code>'b</code> to JSON type <code>'a</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-t.Rec" class="def variant constructor anchored"><a href="#type-t.Rec" class="anchor"></a><code><span>| </span><span><span class="constructor">Rec</span> : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <a href="../../../../stdlib/Stdlib/Lazy/index.html#type-t">Lazy.t</a></span> <span class="arrow">&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Recursive definition.</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>The type for JSON types.</p></div></div><h2 id="array"><a href="#array" class="anchor"></a>Array maps</h2><div class="odoc-spec"><div class="spec type anchored" id="type-array_map"><a href="#type-array_map" class="anchor"></a><code><span><span class="keyword">and</span> <span>('array, 'elt, 'builder) array_map</span></span><span> = </span><span>{</span></code><ol><li id="type-array_map.kind" class="def record field anchored"><a href="#type-array_map.kind" class="anchor"></a><code><span>kind : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The kind of JSON array mapped (documentation).</p><span class="comment-delim">*)</span></div></li><li id="type-array_map.doc" class="def record field anchored"><a href="#type-array_map.doc" class="anchor"></a><code><span>doc : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Documentation string for the JSON array.</p><span class="comment-delim">*)</span></div></li><li id="type-array_map.elt" class="def record field anchored"><a href="#type-array_map.elt" class="anchor"></a><code><span>elt : <span><span class="type-var">'elt</span> <a href="#type-t">t</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The type for the array elements.</p><span class="comment-delim">*)</span></div></li><li id="type-array_map.dec_empty" class="def record field anchored"><a href="#type-array_map.dec_empty" class="anchor"></a><code><span>dec_empty : <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'builder</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dec_empty ()</code> creates a new empty array builder.</p><span class="comment-delim">*)</span></div></li><li id="type-array_map.dec_skip" class="def record field anchored"><a href="#type-array_map.dec_skip" class="anchor"></a><code><span>dec_skip : <span>int <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'builder</span> <span class="arrow">&#45;&gt;</span></span> bool;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dec_skip i b</code> determines if the <code>i</code>th index of the JSON array can be skipped.</p><span class="comment-delim">*)</span></div></li><li id="type-array_map.dec_add" class="def record field anchored"><a href="#type-array_map.dec_add" class="anchor"></a><code><span>dec_add : <span>int <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'elt</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'builder</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'builder</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dec_add</code> adds the <code>i</code>th index value of the JSON array as decoded by <code>elt</code> to the builder.</p><span class="comment-delim">*)</span></div></li><li id="type-array_map.dec_finish" class="def record field anchored"><a href="#type-array_map.dec_finish" class="anchor"></a><code><span>dec_finish : <span><a href="../Meta/index.html#type-t">Meta.t</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'builder</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'array</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dec_finish</code> turns the builder into an array given its metadata and length.</p><span class="comment-delim">*)</span></div></li><li id="type-array_map.enc" class="def record field anchored"><a href="#type-array_map.enc" class="anchor"></a><code><span>enc : 'acc. <span><span>(<span><span class="type-var">'acc</span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'elt</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'acc</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'acc</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'array</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'acc</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>enc</code> folds over the elements of the array for encoding.</p><span class="comment-delim">*)</span></div></li><li id="type-array_map.enc_meta" class="def record field anchored"><a href="#type-array_map.enc_meta" class="anchor"></a><code><span>enc_meta : <span><span class="type-var">'array</span> <span class="arrow">&#45;&gt;</span></span> <a href="../Meta/index.html#type-t">Meta.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>enc_meta</code> recovers the metadata of an array (if any).</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>The type for mapping JSON arrays to values of type <code>'array</code> with array elements mapped to type <code>'elt</code> and using a <code>'builder</code> value to construct the array.</p></div></div><h2 id="object_map"><a href="#object_map" class="anchor"></a>Object maps</h2><div class="odoc-spec"><div class="spec type anchored" id="type-object_map"><a href="#type-object_map" class="anchor"></a><code><span><span class="keyword">and</span> <span>('o, 'dec) object_map</span></span><span> = </span><span>{</span></code><ol><li id="type-object_map.kind" class="def record field anchored"><a href="#type-object_map.kind" class="anchor"></a><code><span>kind : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The kind of JSON object (documentation).</p><span class="comment-delim">*)</span></div></li><li id="type-object_map.doc" class="def record field anchored"><a href="#type-object_map.doc" class="anchor"></a><code><span>doc : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>A doc string for the JSON member.</p><span class="comment-delim">*)</span></div></li><li id="type-object_map.dec" class="def record field anchored"><a href="#type-object_map.dec" class="anchor"></a><code><span>dec : <span><span>(<span class="type-var">'o</span>, <span class="type-var">'dec</span>)</span> <a href="#type-dec_fun">dec_fun</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The object decoding function to construct an <code>'o</code> value.</p><span class="comment-delim">*)</span></div></li><li id="type-object_map.mem_decs" class="def record field anchored"><a href="#type-object_map.mem_decs" class="anchor"></a><code><span>mem_decs : <span><a href="#type-mem_dec">mem_dec</a> <a href="String_map/index.html#type-t">String_map.t</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>mem_decs</code> are the member decoders sorted by member name.</p><span class="comment-delim">*)</span></div></li><li id="type-object_map.mem_encs" class="def record field anchored"><a href="#type-object_map.mem_encs" class="anchor"></a><code><span>mem_encs : <span><span><span class="type-var">'o</span> <a href="#type-mem_enc">mem_enc</a></span> list</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>mem_encs</code> is the list of member encoders.</p><span class="comment-delim">*)</span></div></li><li id="type-object_map.enc_meta" class="def record field anchored"><a href="#type-object_map.enc_meta" class="anchor"></a><code><span>enc_meta : <span><span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span> <a href="../Meta/index.html#type-t">Meta.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>enc_meta</code> recovers the metadata of an object (if any).</p><span class="comment-delim">*)</span></div></li><li id="type-object_map.shape" class="def record field anchored"><a href="#type-object_map.shape" class="anchor"></a><code><span>shape : <span><span class="type-var">'o</span> <a href="#type-object_shape">object_shape</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>shape</code> is the <a href="#type-object_shape" title="object_shape">shape</a> of the object.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>The type for mapping a JSON object to values of type <code>'o</code> using a decoding function of type <code>'dec</code>. <code>mem_decs</code> and <code>mem_encs</code> have the same <a href="#type-mem_map"><code>mem_map</code></a> values they are just sorted differently for decoding and encoding purposes.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-mem_dec"><a href="#type-mem_dec" class="anchor"></a><code><span><span class="keyword">and</span> mem_dec</span><span> = </span></code><ol><li id="type-mem_dec.Mem_dec" class="def variant constructor anchored"><a href="#type-mem_dec.Mem_dec" class="anchor"></a><code><span>| </span><span><span class="constructor">Mem_dec</span> : <span><span>(<span class="type-var">'o</span>, <span class="type-var">'a</span>)</span> <a href="#type-mem_map">mem_map</a></span> <span class="arrow">&#45;&gt;</span> <a href="#type-mem_dec">mem_dec</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The type for member maps in decoding position.</p><span class="comment-delim">*)</span></div></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-mem_enc"><a href="#type-mem_enc" class="anchor"></a><code><span><span class="keyword">and</span> <span>'o mem_enc</span></span><span> = </span></code><ol><li id="type-mem_enc.Mem_enc" class="def variant constructor anchored"><a href="#type-mem_enc.Mem_enc" class="anchor"></a><code><span>| </span><span><span class="constructor">Mem_enc</span> : <span><span>(<span class="type-var">'o</span>, <span class="type-var">'a</span>)</span> <a href="#type-mem_map">mem_map</a></span> <span class="arrow">&#45;&gt;</span> <span><span class="type-var">'o</span> <a href="#type-mem_enc">mem_enc</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The type for member maps in encoding position.</p><span class="comment-delim">*)</span></div></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-mem_map"><a href="#type-mem_map" class="anchor"></a><code><span><span class="keyword">and</span> <span>('o, 'a) mem_map</span></span><span> = </span><span>{</span></code><ol><li id="type-mem_map.name" class="def record field anchored"><a href="#type-mem_map.name" class="anchor"></a><code><span>name : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The JSON member name.</p><span class="comment-delim">*)</span></div></li><li id="type-mem_map.doc" class="def record field anchored"><a href="#type-mem_map.doc" class="anchor"></a><code><span>doc : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Documentation for the JSON member.</p><span class="comment-delim">*)</span></div></li><li id="type-mem_map.type'" class="def record field anchored"><a href="#type-mem_map.type'" class="anchor"></a><code><span>type' : <span><span class="type-var">'a</span> <a href="#type-t">t</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The type for the member value.</p><span class="comment-delim">*)</span></div></li><li id="type-mem_map.id" class="def record field anchored"><a href="#type-mem_map.id" class="anchor"></a><code><span>id : <span><span class="type-var">'a</span> <a href="Type/Id/index.html#type-t">Type.Id.t</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>A type identifier for the member. This allows to store the decode in a <a href="Dict/index.html#type-t"><code>Dict.t</code></a> on decode and give it in time to the object decoding function of the object map.</p><span class="comment-delim">*)</span></div></li><li id="type-mem_map.dec_absent" class="def record field anchored"><a href="#type-mem_map.dec_absent" class="anchor"></a><code><span>dec_absent : <span><span class="type-var">'a</span> option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The value to use if absent (if any).</p><span class="comment-delim">*)</span></div></li><li id="type-mem_map.enc" class="def record field anchored"><a href="#type-mem_map.enc" class="anchor"></a><code><span>enc : <span><span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>enc</code> recovers the value to encode from <code>'o</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-mem_map.enc_omit" class="def record field anchored"><a href="#type-mem_map.enc_omit" class="anchor"></a><code><span>enc_omit : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> bool;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>enc_omit</code> is <code>true</code> if the result of <code>enc</code> should not be encoded.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>The type for mapping a JSON member to a value of type <code>'a</code> in an object represented by a value of type <code>'o</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-object_shape"><a href="#type-object_shape" class="anchor"></a><code><span><span class="keyword">and</span> <span>'o object_shape</span></span><span> = </span></code><ol><li id="type-object_shape.Object_basic" class="def variant constructor anchored"><a href="#type-object_shape.Object_basic" class="anchor"></a><code><span>| </span><span><span class="constructor">Object_basic</span> : <span><span>(<span class="type-var">'o</span>, <span class="type-var">'mems</span>, <span class="type-var">'builder</span>)</span> <a href="#type-unknown_mems">unknown_mems</a></span> <span class="arrow">&#45;&gt;</span> <span><span class="type-var">'o</span> <a href="#type-object_shape">object_shape</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>A basic object, possibly indicating how to handle unknown members</p><span class="comment-delim">*)</span></div></li><li id="type-object_shape.Object_cases" class="def variant constructor anchored"><a href="#type-object_shape.Object_cases" class="anchor"></a><code><span>| </span><span><span class="constructor">Object_cases</span> : <span><span><span>(<span class="type-var">'o</span>, <span class="type-var">'mems</span>, <span class="type-var">'builder</span>)</span> <a href="#type-unknown_mems">unknown_mems</a></span> option</span>
  * <span><span>(<span class="type-var">'o</span>, <span class="type-var">'cases</span>, <span class="type-var">'tag</span>)</span> <a href="#type-object_cases">object_cases</a></span> <span class="arrow">&#45;&gt;</span> <span><span class="type-var">'o</span> <a href="#type-object_shape">object_shape</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>An object with a case member each case further describing an object map.</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>The type for object shapes.</p></div></div><h3 id="unknown_mems"><a href="#unknown_mems" class="anchor"></a>Unknown members</h3><div class="odoc-spec"><div class="spec type anchored" id="type-unknown_mems"><a href="#type-unknown_mems" class="anchor"></a><code><span><span class="keyword">and</span> <span>('o, 'mems, 'builder) unknown_mems</span></span><span> = </span></code><ol><li id="type-unknown_mems.Unknown_skip" class="def variant constructor anchored"><a href="#type-unknown_mems.Unknown_skip" class="anchor"></a><code><span>| </span><span><span class="constructor">Unknown_skip</span> : <span><span>(<span class="type-var">'o</span>, unit, unit)</span> <a href="#type-unknown_mems">unknown_mems</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Skip unknown members.</p><span class="comment-delim">*)</span></div></li><li id="type-unknown_mems.Unknown_error" class="def variant constructor anchored"><a href="#type-unknown_mems.Unknown_error" class="anchor"></a><code><span>| </span><span><span class="constructor">Unknown_error</span> : <span><span>(<span class="type-var">'o</span>, unit, unit)</span> <a href="#type-unknown_mems">unknown_mems</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Error on unknown members.</p><span class="comment-delim">*)</span></div></li><li id="type-unknown_mems.Unknown_keep" class="def variant constructor anchored"><a href="#type-unknown_mems.Unknown_keep" class="anchor"></a><code><span>| </span><span><span class="constructor">Unknown_keep</span> : <span><span>(<span class="type-var">'mems</span>, <span class="type-var">'a</span>, <span class="type-var">'builder</span>)</span> <a href="#type-mems_map">mems_map</a></span>
  * <span>(<span><span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'mems</span>)</span> <span class="arrow">&#45;&gt;</span> <span><span>(<span class="type-var">'o</span>, <span class="type-var">'mems</span>, <span class="type-var">'builder</span>)</span> <a href="#type-unknown_mems">unknown_mems</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Gather unknown members in a member map.</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>The type for specifying decoding behaviour on unknown JSON object members.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-mems_map"><a href="#type-mems_map" class="anchor"></a><code><span><span class="keyword">and</span> <span>('mems, 'a, 'builder) mems_map</span></span><span> = </span><span>{</span></code><ol><li id="type-mems_map.kind" class="def record field anchored"><a href="#type-mems_map.kind" class="anchor"></a><code><span>kind : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The kind for unknown members (documentation).</p><span class="comment-delim">*)</span></div></li><li id="type-mems_map.doc" class="def record field anchored"><a href="#type-mems_map.doc" class="anchor"></a><code><span>doc : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Documentation string for the unknown members.</p><span class="comment-delim">*)</span></div></li><li id="type-mems_map.mems_type" class="def record field anchored"><a href="#type-mems_map.mems_type" class="anchor"></a><code><span>mems_type : <span><span class="type-var">'a</span> <a href="#type-t">t</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The uniform type according which unknown members are typed.</p><span class="comment-delim">*)</span></div></li><li id="type-mems_map.id" class="def record field anchored"><a href="#type-mems_map.id" class="anchor"></a><code><span>id : <span><span class="type-var">'mems</span> <a href="Type/Id/index.html#type-t">Type.Id.t</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>A type identifier for the unknown member map.</p><span class="comment-delim">*)</span></div></li><li id="type-mems_map.dec_empty" class="def record field anchored"><a href="#type-mems_map.dec_empty" class="anchor"></a><code><span>dec_empty : <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'builder</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dec_empty</code> create a new empty member map builder.</p><span class="comment-delim">*)</span></div></li><li id="type-mems_map.dec_add" class="def record field anchored"><a href="#type-mems_map.dec_add" class="anchor"></a><code><span>dec_add : <span><a href="../Meta/index.html#type-t">Meta.t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'builder</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'builder</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dec_add</code> adds a member named <code>n</code> with metadata <code>meta</code> and value parsed by <code>mems_type</code> to the builder.</p><span class="comment-delim">*)</span></div></li><li id="type-mems_map.dec_finish" class="def record field anchored"><a href="#type-mems_map.dec_finish" class="anchor"></a><code><span>dec_finish : <span><a href="../Meta/index.html#type-t">Meta.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'builder</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'mems</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dec_finish</code> turns the builder into an unknown member map. The <code>meta</code> is the meta data of the object in which they were found.</p><span class="comment-delim">*)</span></div></li><li id="type-mems_map.enc" class="def record field anchored"><a href="#type-mems_map.enc" class="anchor"></a><code><span>enc : 'acc. <span><span>(<span><a href="../Meta/index.html#type-t">Meta.t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'acc</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'acc</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'mems</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'acc</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'acc</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>enc</code> folds over the member map for encoding.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>The type for gathering unknown JSON members uniformly typed according to <code>'a</code> in a map <code>'mems</code> constructed with <code>'builder</code>.</p></div></div><h3 id="case_objects"><a href="#case_objects" class="anchor"></a>Case objects</h3><div class="odoc-spec"><div class="spec type anchored" id="type-object_cases"><a href="#type-object_cases" class="anchor"></a><code><span><span class="keyword">and</span> <span>('o, 'cases, 'tag) object_cases</span></span><span> = </span><span>{</span></code><ol><li id="type-object_cases.tag" class="def record field anchored"><a href="#type-object_cases.tag" class="anchor"></a><code><span>tag : <span><span>(<span class="type-var">'tag</span>, <span class="type-var">'tag</span>)</span> <a href="#type-mem_map">mem_map</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The JSON member used to decide cases. The <code>enc</code> field of this <code>mem_map</code> should be the identity, this allows encoders to reuse generic encoding code for members. We don't have <code>('o, 'tag) mem_map</code> here because the tag is not stored we recover the case via <code>enc</code> and <code>enc_case</code> below.</p><span class="comment-delim">*)</span></div></li><li id="type-object_cases.tag_compare" class="def record field anchored"><a href="#type-object_cases.tag_compare" class="anchor"></a><code><span>tag_compare : <span><span class="type-var">'tag</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'tag</span> <span class="arrow">&#45;&gt;</span></span> int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The function to compare tags.</p><span class="comment-delim">*)</span></div></li><li id="type-object_cases.tag_to_string" class="def record field anchored"><a href="#type-object_cases.tag_to_string" class="anchor"></a><code><span>tag_to_string : <span><span>(<span><span class="type-var">'tag</span> <span class="arrow">&#45;&gt;</span></span> string)</span> option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The function to stringify tags for error reporting.</p><span class="comment-delim">*)</span></div></li><li id="type-object_cases.id" class="def record field anchored"><a href="#type-object_cases.id" class="anchor"></a><code><span>id : <span><span class="type-var">'cases</span> <a href="Type/Id/index.html#type-t">Type.Id.t</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>A type identifier for the tag.</p><span class="comment-delim">*)</span></div></li><li id="type-object_cases.cases" class="def record field anchored"><a href="#type-object_cases.cases" class="anchor"></a><code><span>cases : <span><span><span>(<span class="type-var">'cases</span>, <span class="type-var">'tag</span>)</span> <a href="#type-case">case</a></span> list</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The list of possible cases.</p><span class="comment-delim">*)</span></div></li><li id="type-object_cases.enc" class="def record field anchored"><a href="#type-object_cases.enc" class="anchor"></a><code><span>enc : <span><span class="type-var">'o</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'cases</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>enc</code> is the function to recover case values from the value <code>'o</code> the object is mapped to.</p><span class="comment-delim">*)</span></div></li><li id="type-object_cases.enc_case" class="def record field anchored"><a href="#type-object_cases.enc_case" class="anchor"></a><code><span>enc_case : <span><span class="type-var">'cases</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'cases</span>, <span class="type-var">'tag</span>)</span> <a href="#type-case_value">case_value</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>enc_case</code> retrieves the concrete case from the common <code>cases</code> values. You can see it as preforming a match.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>The type for object cases mapped to a common type <code>'cases</code> stored in a vlue of type <code>'o</code> and identified by tag values of type <code>'tag</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-case_map"><a href="#type-case_map" class="anchor"></a><code><span><span class="keyword">and</span> <span>('cases, 'case, 'tag) case_map</span></span><span> = </span><span>{</span></code><ol><li id="type-case_map.tag" class="def record field anchored"><a href="#type-case_map.tag" class="anchor"></a><code><span>tag : <span class="type-var">'tag</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The tag value for the case.</p><span class="comment-delim">*)</span></div></li><li id="type-case_map.object_map" class="def record field anchored"><a href="#type-case_map.object_map" class="anchor"></a><code><span>object_map : <span><span>(<span class="type-var">'case</span>, <span class="type-var">'case</span>)</span> <a href="#type-object_map">object_map</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The object map for the case.</p><span class="comment-delim">*)</span></div></li><li id="type-case_map.dec" class="def record field anchored"><a href="#type-case_map.dec" class="anchor"></a><code><span>dec : <span><span class="type-var">'case</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'cases</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dec</code> is the function used on decoding to inject the case into the common <code>'cases</code> type.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>The type for an object case with common type <code>'cases</code> specific type <code>'case</code> and tag type <code>'tag</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-case_value"><a href="#type-case_value" class="anchor"></a><code><span><span class="keyword">and</span> <span>('cases, 'tag) case_value</span></span><span> = </span></code><ol><li id="type-case_value.Case_value" class="def variant constructor anchored"><a href="#type-case_value.Case_value" class="anchor"></a><code><span>| </span><span><span class="constructor">Case_value</span> : <span><span>(<span class="type-var">'cases</span>, <span class="type-var">'case</span>, <span class="type-var">'tag</span>)</span> <a href="#type-case_map">case_map</a></span>
  * <span class="type-var">'case</span> <span class="arrow">&#45;&gt;</span> <span><span>(<span class="type-var">'cases</span>, <span class="type-var">'tag</span>)</span> <a href="#type-case_value">case_value</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The type for case values. This packs a case value and its description.</p><span class="comment-delim">*)</span></div></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-case"><a href="#type-case" class="anchor"></a><code><span><span class="keyword">and</span> <span>('cases, 'tag) case</span></span><span> = </span></code><ol><li id="type-case.Case" class="def variant constructor anchored"><a href="#type-case.Case" class="anchor"></a><code><span>| </span><span><span class="constructor">Case</span> : <span><span>(<span class="type-var">'cases</span>, <span class="type-var">'case</span>, <span class="type-var">'tag</span>)</span> <a href="#type-case_map">case_map</a></span> <span class="arrow">&#45;&gt;</span> <span><span>(<span class="type-var">'cases</span>, <span class="type-var">'tag</span>)</span> <a href="#type-case">case</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The type for hiding the the concrete type of a case .</p><span class="comment-delim">*)</span></div></li></ol></div></div><h2 id="any"><a href="#any" class="anchor"></a>Any maps</h2><div class="odoc-spec"><div class="spec type anchored" id="type-any_map"><a href="#type-any_map" class="anchor"></a><code><span><span class="keyword">and</span> <span>'a any_map</span></span><span> = </span><span>{</span></code><ol><li id="type-any_map.kind" class="def record field anchored"><a href="#type-any_map.kind" class="anchor"></a><code><span>kind : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The kind of JSON values mapped (documentation).</p><span class="comment-delim">*)</span></div></li><li id="type-any_map.doc" class="def record field anchored"><a href="#type-any_map.doc" class="anchor"></a><code><span>doc : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Documentation string for the kind of values.</p><span class="comment-delim">*)</span></div></li><li id="type-any_map.dec_null" class="def record field anchored"><a href="#type-any_map.dec_null" class="anchor"></a><code><span>dec_null : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dec_null</code>, if any, is used for decoding JSON nulls.</p><span class="comment-delim">*)</span></div></li><li id="type-any_map.dec_bool" class="def record field anchored"><a href="#type-any_map.dec_bool" class="anchor"></a><code><span>dec_bool : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dec_bool</code>, if any, is used for decoding JSON bools.</p><span class="comment-delim">*)</span></div></li><li id="type-any_map.dec_number" class="def record field anchored"><a href="#type-any_map.dec_number" class="anchor"></a><code><span>dec_number : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dec_number</code>, if any, is used for decoding JSON numbers.</p><span class="comment-delim">*)</span></div></li><li id="type-any_map.dec_string" class="def record field anchored"><a href="#type-any_map.dec_string" class="anchor"></a><code><span>dec_string : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dec_string</code>, if any, is used for decoding JSON strings.</p><span class="comment-delim">*)</span></div></li><li id="type-any_map.dec_array" class="def record field anchored"><a href="#type-any_map.dec_array" class="anchor"></a><code><span>dec_array : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dec_array</code>, if any, is used for decoding JSON arrays.</p><span class="comment-delim">*)</span></div></li><li id="type-any_map.dec_object" class="def record field anchored"><a href="#type-any_map.dec_object" class="anchor"></a><code><span>dec_object : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dec_object</code>, if any, is used for decoding JSON objects.</p><span class="comment-delim">*)</span></div></li><li id="type-any_map.enc" class="def record field anchored"><a href="#type-any_map.enc" class="anchor"></a><code><span>enc : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>enc</code> specifies the encoder to use on a given value.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>The type for mapping JSON values with multiple sorts to a value of type <code>'a</code>. If a decoding case is <code>None</code>, the decoding errors on these JSON values.</p></div></div><h2 id="type_map"><a href="#type_map" class="anchor"></a>Type maps</h2><div class="odoc-spec"><div class="spec type anchored" id="type-map"><a href="#type-map" class="anchor"></a><code><span><span class="keyword">and</span> <span>('a, 'b) map</span></span><span> = </span><span>{</span></code><ol><li id="type-map.kind" class="def record field anchored"><a href="#type-map.kind" class="anchor"></a><code><span>kind : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The kind of JSON values mapped (documentation).</p><span class="comment-delim">*)</span></div></li><li id="type-map.doc" class="def record field anchored"><a href="#type-map.doc" class="anchor"></a><code><span>doc : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Documentation string for the kind of values.</p><span class="comment-delim">*)</span></div></li><li id="type-map.dom" class="def record field anchored"><a href="#type-map.dom" class="anchor"></a><code><span>dom : <span><span class="type-var">'a</span> <a href="#type-t">t</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The domain of the map.</p><span class="comment-delim">*)</span></div></li><li id="type-map.dec" class="def record field anchored"><a href="#type-map.dec" class="anchor"></a><code><span>dec : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dec</code> decodes <code>'a</code> to <code>'b</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-map.enc" class="def record field anchored"><a href="#type-map.enc" class="anchor"></a><code><span>enc : <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>enc</code> encodes <code>'b</code> to <code>'a</code>.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>The type for mapping JSON types of type <code>'a</code> to a JSON type of type <code>'b</code>.</p></div></div><h2 id="conv"><a href="#conv" class="anchor"></a>Convert</h2><div class="odoc-spec"><div class="spec value anchored" id="val-of_t"><a href="#val-of_t" class="anchor"></a><code><span><span class="keyword">val</span> of_t : <span><span><span class="type-var">'a</span> <a href="#type-t'">t'</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>of_t</code> is <a href="../../../../stdlib/Stdlib/Fun/index.html#val-id"><code>Stdlib.Fun.id</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unsafe_to_t"><a href="#val-unsafe_to_t" class="anchor"></a><code><span><span class="keyword">val</span> unsafe_to_t : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t'">t'</a></span></span></code></div><div class="spec-doc"><p><code>unsafe_to_t r</code> converts the representation to a type <code>r</code>. It is unsafe because constructors of the <a href="../index.html"><code>Jsont</code></a> module do maintain some invariants.</p></div></div><h2 id="kinds"><a href="#kinds" class="anchor"></a>Kinds and doc</h2><div class="odoc-spec"><div class="spec value anchored" id="val-kinded_sort"><a href="#val-kinded_sort" class="anchor"></a><code><span><span class="keyword">val</span> kinded_sort : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>kinded_sort t</code> is kinded sort of <code>t</code>, see <a href="../index.html#val-kinded_sort"><code>Jsont.kinded_sort</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-array_map_kinded_sort"><a href="#val-array_map_kinded_sort" class="anchor"></a><code><span><span class="keyword">val</span> array_map_kinded_sort : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'elt</span>, <span class="type-var">'builder</span>)</span> <a href="#type-array_map">array_map</a></span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>array_map_kinded_sort map</code> is like <a href="#val-kinded_sort"><code>kinded_sort</code></a> but acts directly on the array <code>map</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-object_map_kinded_sort"><a href="#val-object_map_kinded_sort" class="anchor"></a><code><span><span class="keyword">val</span> object_map_kinded_sort : <span><span><span>(<span class="type-var">'o</span>, <span class="type-var">'dec</span>)</span> <a href="#type-object_map">object_map</a></span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>object_map_kind map</code> is like <a href="#val-kinded_sort"><code>kinded_sort</code></a> but acts directly on the object <code>map</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_kind"><a href="#val-pp_kind" class="anchor"></a><code><span><span class="keyword">val</span> pp_kind : <span>string <a href="../index.html#type-fmt">fmt</a></span></span></code></div><div class="spec-doc"><p><code>pp_kind</code> formats kinds.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-doc"><a href="#val-doc" class="anchor"></a><code><span><span class="keyword">val</span> doc : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>See <a href="../index.html#val-doc"><code>Jsont.doc</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_doc"><a href="#val-with_doc" class="anchor"></a><code><span><span class="keyword">val</span> with_doc : <span><span class="optlabel">?kind</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?doc</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>See <a href="../index.html#val-with_doc"><code>Jsont.with_doc</code></a>.</p></div></div><h2 id="errors"><a href="#errors" class="anchor"></a>Errors</h2><div class="odoc-spec"><div class="spec value anchored" id="val-error_push_array"><a href="#val-error_push_array" class="anchor"></a><code><span><span class="keyword">val</span> error_push_array : 
  <span><a href="../Meta/index.html#type-t">Meta.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'array</span>, <span class="type-var">'elt</span>, <span class="type-var">'builder</span>)</span> <a href="#type-array_map">array_map</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>int <a href="../index.html#type-node">node</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Error/index.html#type-t">Error.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>error_push_array</code> is like <a href="../Error/index.html#val-push_array"><code>Error.push_array</code></a> but uses the given array <code>meta</code> and array map to caracterize the context.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-error_push_object"><a href="#val-error_push_object" class="anchor"></a><code><span><span class="keyword">val</span> error_push_object : 
  <span><a href="../Meta/index.html#type-t">Meta.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'o</span>, <span class="type-var">'dec</span>)</span> <a href="#type-object_map">object_map</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>string <a href="../index.html#type-node">node</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Error/index.html#type-t">Error.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>error_push_object</code> is like <a href="../Error/index.html#val-push_object"><code>Error.push_object</code></a> but uses the given object <code>meta</code> and object map to caracterize the context.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-type_error"><a href="#val-type_error" class="anchor"></a><code><span><span class="keyword">val</span> type_error : <span><a href="../Meta/index.html#type-t">Meta.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">fnd</span>:<a href="../Sort/index.html#type-t">Sort.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span></span></code></div><div class="spec-doc"><p><code>type_error meta ~exp ~fnd</code> errors when kind <code>exp</code> was expected but sort <code>fnd</code> was found.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-missing_mems_error"><a href="#val-missing_mems_error" class="anchor"></a><code><span><span class="keyword">val</span> missing_mems_error : 
  <span><a href="../Meta/index.html#type-t">Meta.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'o</span>, <span class="type-var">'o</span>)</span> <a href="#type-object_map">object_map</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">exp</span>:<span><a href="#type-mem_dec">mem_dec</a> <a href="String_map/index.html#type-t">String_map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">fnd</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>missing_mems_error m map exp fnd</code> errors when <code>exp</code> cannot be found, <code>fnd</code> can list a few members that were found.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unexpected_mems_error"><a href="#val-unexpected_mems_error" class="anchor"></a><code><span><span class="keyword">val</span> unexpected_mems_error : 
  <span><a href="../Meta/index.html#type-t">Meta.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'o</span>, <span class="type-var">'o</span>)</span> <a href="#type-object_map">object_map</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">fnd</span>:<span><span>(string * <a href="../Meta/index.html#type-t">Meta.t</a>)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>unexpected_mems_error meta map ~fnd</code> errors when <code>fnd</code> are unexpected members for object <code>map</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unexpected_case_tag_error"><a href="#val-unexpected_case_tag_error" class="anchor"></a><code><span><span class="keyword">val</span> unexpected_case_tag_error : 
  <span><a href="../Meta/index.html#type-t">Meta.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'o</span>, <span class="type-var">'o</span>)</span> <a href="#type-object_map">object_map</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'o</span>, <span class="type-var">'d</span>, <span class="type-var">'tag</span>)</span> <a href="#type-object_cases">object_cases</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'tag</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>unexpected_case_tag_error meta map cases tag</code> is when a <code>tag</code> of a case member has no corresponding case.</p></div></div><h2 id="toolbox"><a href="#toolbox" class="anchor"></a>Processor toolbox</h2><div class="odoc-spec"><div class="spec value anchored" id="val-object_meta_arg"><a href="#val-object_meta_arg" class="anchor"></a><code><span><span class="keyword">val</span> object_meta_arg : <span><a href="../Meta/index.html#type-t">Meta.t</a> <a href="Type/Id/index.html#type-t">Type.Id.t</a></span></span></code></div><div class="spec-doc"><p><code>object_meta_arg</code> holds the <a href="../Object/index.html#val-mem"><code>Jsont.Object.mem</code></a> to</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Dict"><a href="#module-Dict" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Dict/index.html">Dict</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Heterogeneous dictionaries.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-apply_dict"><a href="#val-apply_dict" class="anchor"></a><code><span><span class="keyword">val</span> apply_dict : <span><span><span>(<span class="type-var">'ret</span>, <span class="type-var">'f</span>)</span> <a href="#type-dec_fun">dec_fun</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="Dict/index.html#type-t">Dict.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'f</span></span></code></div><div class="spec-doc"><p><code>apply_dict dec dict</code> applies <code>dict</code> to <code>f</code> in order to get the value <code>'f</code>. Raises <code>Invalid_argument</code> if <code>dict</code> has not all the type identifiers that <code>dec</code> needs.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-unknown_mems_option"><a href="#type-unknown_mems_option" class="anchor"></a><code><span><span class="keyword">type</span> unknown_mems_option</span><span> = </span></code><ol><li id="type-unknown_mems_option.Unknown_mems" class="def variant constructor anchored"><a href="#type-unknown_mems_option.Unknown_mems" class="anchor"></a><code><span>| </span><span><span class="constructor">Unknown_mems</span> : <span><span><span>(<span class="type-var">'o</span>, <span class="type-var">'mems</span>, <span class="type-var">'builder</span>)</span> <a href="#type-unknown_mems">unknown_mems</a></span> option</span> <span class="arrow">&#45;&gt;</span> <a href="#type-unknown_mems_option">unknown_mems_option</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>A type for hiding an optional <a href="#type-unknown_mems"><code>unknown_mems</code></a> values.</p><span class="comment-delim">*)</span></div></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-override_unknown_mems"><a href="#val-override_unknown_mems" class="anchor"></a><code><span><span class="keyword">val</span> override_unknown_mems : 
  <span><span class="label">by</span>:<a href="#type-unknown_mems_option">unknown_mems_option</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-unknown_mems_option">unknown_mems_option</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="Dict/index.html#type-t">Dict.t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-unknown_mems_option">unknown_mems_option</a> * <a href="Dict/index.html#type-t">Dict.t</a></span></code></div><div class="spec-doc"><p><code>override_unknown_mems ~by current dict</code> preforms the unknown member overriding logic for <a href="../Object/Case/index.html"><code>Jsont.Object.Case</code></a> objects. In particular if <code>current</code> is a <a href="../Object/Mems/index.html#val-map"><code>Jsont.Object.Mems.map</code></a> it adds an empty one in <code>dict</code> so that the associated decoding function does not fail.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-finish_object_decode"><a href="#val-finish_object_decode" class="anchor"></a><code><span><span class="keyword">val</span> finish_object_decode : 
  <span><span><span>(<span class="type-var">'o</span>, <span class="type-var">'o</span>)</span> <a href="#type-object_map">object_map</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Meta/index.html#type-t">Meta.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'p</span>, <span class="type-var">'mems</span>, <span class="type-var">'builder</span>)</span> <a href="#type-unknown_mems">unknown_mems</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'builder</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-mem_dec">mem_dec</a> <a href="String_map/index.html#type-t">String_map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="Dict/index.html#type-t">Dict.t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="Dict/index.html#type-t">Dict.t</a></span></code></div><div class="spec-doc"><p><code>finish_object_decode map meta unknown_mems umap rem_mems dict</code> finishes an object map <code>map</code> decode. It adds the <code>umap</code> (if needed) to <code>dict</code>, it adds <code>meta</code> to <code>dict</code> under <a href="#val-object_meta_arg"><code>object_meta_arg</code></a> and tries to find andd default values to <code>dict</code> for <code>rem_mems</code> (and errors if it can't).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_code"><a href="#val-pp_code" class="anchor"></a><code><span><span class="keyword">val</span> pp_code : <span>string <a href="../index.html#type-fmt">fmt</a></span></span></code></div><div class="spec-doc"><p><code>pp_code</code> formats strings like code (in bold).</p></div></div></div></body></html>
